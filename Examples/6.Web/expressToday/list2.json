"系统中的帐号名称具有唯一性。
适用于：操作员帐号、程序帐号、最终用户帐号。
说明：账号名称长度建议6-32个字符；并限制有转义功能的特殊字符。可采用黑名单限制（XML转义字符有&，<,>,双引号"",单引号'；HTML转义字符有&,<,>,双引号"",空格，注册符，版权符）。因为有许多特殊字符是转义字符，如HTML中“&nbsp”表示空格，所以为了防止对这种转义字符的攻击，产品应根据系统需要来限制特殊字符。"
"产品应该提供帐号的基本管理能力，包括对帐号的增加、删除、修改和查询。
说明：其中帐号修改包括了对帐号基本信息（如角色等）、帐号状态（例如：激活、去激活、锁定、暂停、禁用）的修改，不同的应用场景，帐号包括的状态不一样。"
"系统提供人工帐号锁定/解锁功能。
说明：当发现某帐号异常或者有用户反馈帐号被盗用时，可以人工对帐号进行锁定；帐号人工锁定包括操作员帐号和最终用户帐号，可以分别提供操作员帐号锁定操作界面和最终用户帐号锁定操作界面。锁定账号需经两级以上审批。"
"任何帐号不能写死在代码中，须提供可管理（或配置）机制。
"
"改变帐号权限或状态时，由管理员决定是否同时终止该帐号当前已建立的会话。

说明：当管理员改变帐号权限或状态时，系统检查帐号当前是否已经建立会话，如果已经建立会话，则提示管理员是否终止该帐号当前已建立的会话，当管理员选择“是”，则系统终止该帐号当前已建立的会话；当管理员选择“否”，则系统仅改变帐号权限或状态，不终止该帐号当前已建立的会话。"
"应用系统人机帐号、机机帐号分离，用于程序间通信的机机帐号不能作为系统维护的人机帐号。

说明：人机帐号和机机帐号的管理要求不同，如果不分离，将出现帐号管理的混乱。
1、应用系统中，人机帐号只能用于系统维护，不能同时作为机机帐号使用
2、应用系统中，机机帐号只能用于程序运行，在用户登录界面中，禁止使用机机帐号进行认证登录。"
记录和显示帐号最后登录时间
管理员/操作员拥有的功能需详细定义

"当用户访问受限资源、功能或者第三方调用系统提供的接口时，必须对访问或请求发起方进行认证。
说明：解决方案组件间也需要有认证机制。

可根据系统要求，选用相应的认证方式，可选的认证方式有：
1.用户所知道的，如口令、口令词（口令和其他校验码组合）；
2.用户所拥有的，如密钥认证、证书认证、智能卡认证、USB Key认证、动态口令认证；
3.用户本身具有的，如生物技术(如指纹、虹膜等）
基于IP的认证是一种不安全的认证方式，应尽量避免使用。"
"当口令不能满足认证安全要求时，要使用更强认证方法，如数字证书、一次性口令等。
说明：当用户名口令认证无法满足安全要求时，需要使用合适的更强认证方法，增强安全性；如数字证书、一次性口令等等机制。

说明：
例如对管理员等重要帐号建议实施强身份认证：
1、对于管理员帐号，应进行双因素或多因素认证（如：静态口令+动态口令、pin码+密钥）。
2、对于管理员，应使用数字证书作为认证凭据。
"
"生成数字证书需满足业界证书的标准安全要求。
在TLS、数字签名等应用场景中使用的数字证书需满足业界安全要求，如：
1、支持使用权威证书机构生成数字证书，不使用自签名证书，以客户实际数字证书应用要求为准。对于产品预置的证书，要使用X.509v3格式的数字证书，其使用的签名算法是SHA256RSA或SHA256ECDSA。
2、对于产品预置的证书，指纹算法可以使用SHA1、MD5等哈希算法，建议使用SHA256及以上强度算法。
3、对于产品预置的证书,RSA证书的密钥长度至少为2048bit。椭圆曲线ECC证书的密钥长度至少为256bit。
4、对于设备预置的证书，数字证书对应的私钥必须支持按照PKCS标准格式进行安全加密存储。不允许将私钥明文存储在磁盘和NVRAM、FLASH等存储介质中。
5、对于华为预置颁发的证书或自研系统生成的证书，用于加密私钥的口令的复杂度必须满足口令复杂度要求。
6.控制私钥文件和证书文件的访问权限，以Linux系统为例，私钥和证书文件的访问权限建议设置为600或640，防止其他用户读写。
7、支持证书替换功能（用于内层软件完整性验证的数字证书除外），并在产品资料中提示风险，建议客户替换成自己的证书和公私钥对。
8、产品禁止提供导出华为预置证书私钥的接口。
（1）产品禁止通过界面上、工具或API接口提供私钥导出功能；
（2）产品必须对私钥文件做严格的文件权限控制，防止非授权用户通过文件读取、下载这些操作系统通用接口获得数字证书私钥。
9、在SSL/TLS、IPSEC等使用数字证书实现身份认证的场景，必须验证对端证书的有效性，必选验证项包括对端证书是否由受信根CA签发、是否在有效期内。"
"对用户的最终认证处理过程必须放到服务器进行。

对于“客户端/服务端”软件系统的用户最终认证处理过程放到服务端进行。此处“客户端/服务端”软件系统是相对于单机版软件系统而言的。不允许以客户端验证的结果作为用户最终认证结果，必须在服务端进行最终的认证处理（如果采用集中认证，那么对用户的最终认证就是放在集中认证服务端进行）。
在 B/S 应用中，对用户的最终认证处理过程不允许仅仅通过脚本或其他形式在客户端进行验证，必须在应用服务器进行最终认证处理（如果采用集中认证，那么对用户的最终认证就是放在集中认证服务器进行）。"
"认证失败后，不能提示给用户详细以及明确的错误原因，可以给出一般性的提示。

说明：
1、可以提示：“用户名或者口令错误，登录失败”、“The sign in information you entered was not correct. Please try again.”；不能提示：“用户名不存在”、“口令错误”等等。
2、通过认证前的提示信息应尽可能少，特别不能包含操作系统、应用软件的名称、版本等信息。如，通过认证前用户不能通过提示信息看到操作系统版本号（如：AIX 5.1）、登录协议的版本号（如：SSH V2）、或者应用系统的版本号

3、如果认证失败的返回报文中携带了错误码，错误码应同时代表“用户名或密码错误”的含义；通过分析错误码应无法分析出可能的错误原因是“用户名不存在”、“口令必须是6位”、“用户名无效”之类的具体错误。"
"在 B/S 应用中，网页上的登录/认证表单必须加入验证码。
说明：
建议集成网络安全工程部提供的验证码CBB（该CBB已经集成到BME中）；使用验证码的目的是为了阻止攻击者使用自动登录工具连续尝试登录，从而降低被暴力破解的可能。如果觉得验证码影响用户体验，那么可以在前 3 次登录尝试中不使用验证码，3 次登录失败后必须使用验证码。验证码在设计上必须要考虑到一些安全因素，以免能被轻易地破解和绕过。"
"在 B/S 应用中，对于管理PORTAL，禁止使用“自动登录/记住我”功能。
说明：
“自动登录/记住我”功能可能被利用于CSRF（跨站请求伪造）攻击；如果运营商有明确的要求，也建议将该功能做成可配置，而且默认是关闭的。"
"对于重要的管理事务或重要的交易事务要进行重新认证，以防范会话劫持和跨站请求伪造给用户带来损失。
对于如下场景下，必须支持重认证机制：
1、终端用户操作超时被断开，重新连接时须进行重新认证；
2、修改口令时须进行重新认证，例如输入旧口令。（管理员重置其他用户口令属于特权管理，可例外）
3、解除会话锁定时须进行重新认证；
4、大金额的操作时须进行重新认证；
5、执行对系统或应用有重大影响的操作（由产品自行确定）时须进行重新鉴别或更高强度的鉴别。"

"验证码必须是单一图片，且只能采用 JPEG、PNG 或 GIF 格式。
说明：

验证码不能使用文本格式，不允许多图片组合（如用四个图片拼成的验证码），多个图片文件组合的验证码性能差且相对容易被自动化工具识别。
"
"验证码字符串要求是随机生成，生成的随机数必须是安全的。
说明：
对于 java 语言可以使用类 java.security.SecureRandom 来生成安全的随机数。不允许使用固定的随机种子，不允许使用当前时间作为随机种子。
"
验证码的每个字符的字体、大小、位置必须随机变化。
验证码的字符能够进行扭曲、粘连。
"验证码内容不能与客户端提交的任何信息相关联。
说明：
在使用验证码生成模块时不允许接收来自客户端的任何参数，例如：禁止通过getcode.jsp?code=1234 的 URL 请求，将 1234 作为验证码随机数。
"
"验证码模块生成的随机数不能在客户端的静态页面中的网页源代码里出现。
说明：
在客户端网页上点击鼠标右键、选择“查看源文件”时，必须看不到验证码模块生成的随机数。
"
验证码要求有背景干扰，背景干扰元素的颜色、位置、数量要求随机变化。
"验证码在一次使用后要求立即失效，新的请求需要重新生成验证码。
说明：
进行验证码校验后，立即将会话中的验证码信息清空，而不是等到生成新的验证码时再去覆盖旧的验证码，防止验证码多次有效；注意：当客户端提交的验证码为空，验证不通过。
"
"验证码和验证信息（如：用户名和口令）必须同时发送给服务器，而且只有当验证码检验通过后才能进行验证信息的检验。
"

"C端用户帐号的口令长度至少6个字符，其他类型帐号（如：操作员帐号和程序帐号）的口令至少8个字符）；若设置的口令不符合上述规则，必须进行警告；对于输入受限、符合业界惯例的场景，不强制要求口令复杂度。

说明：
C端用户口令
• 长度最少6个字符
• 同时包括数字和英文字符
操作员口令和程序口令
• 长度至少为8个字符
• 同时包含数字和英文字母大小写字符"
"口令必须包含如下至少两种字符的组合:
－至少一个小写字母；
－至少一个大写字母；
－至少一个数字；
－至少一个特殊字符：`~!@#$%^&*()-_=+\|[{}];:'"",<.>/?  和空格
若设置的口令不符合上述规则，必须进行警告；对于输入受限、符合业界惯例的场景，不强制要求口令复杂度。
适用于：操作员帐号、程序帐号。

口令包含字符集越多猜测和破解的难度就越大。对于需要通过固定话机等仅支持数字输入的设备，来输入口令的场景，不强制口令包含数字以外的字符。"
"当口令是系统自动生成时，则需要随机生成，并同时满足“口令长度”、“口令包含的字符”等要求，同时随机数算法需要满足“使用安全的随机数算法”要求。
适用于：操作员帐号、程序帐号、最终用户帐号的口令
说明：
请参考：“口令长度”、“口令包含的字符”"
新口令与旧口令必须有最少一个字符或以上差异。
"口令须设置有效期，口令有效期须可配置，最短有效期的取值范围：0-9999 分钟，建议默认：5分钟；最长有效期的取值范围：0-999 天，当取值为 0 时，表示口令永久有效，建议默认：90 天（约 3 个月）。
适用于：操作员帐号的口令。
说明：
建议做成可配置；最短有效期就是控制操作员在修改口令后不能立即再次修改口令，这样做的目的是阻止操作员在很短的时间内设置超过记住的历史口令个数的口令，以达到再次设回原来口令的目的。最长有效期就是控制避免长期使用一个口令而不更改。"
"在口令到期前，当用户登录时系统须进行提示，提前提示的天数可配置，取值范围：0-99 天，当取值为 0 时，表示不提示，建议默认：7 天。
适用于：操作员帐号的口令。"
"口令到达最长有效期后，用户再次登录成功但在进入系统前，系统强制更改口令，直至更改成功。
适用于：操作员帐号的口令。"
用户修改自己口令时必须验证旧口令，必须要二次输入新口令以确认没有输入错误，并且新口令须满足“口令长度”、“口令包含的字符”等要求。不允许修改除自身帐号以外的帐号的口令（管理员除外）。
"如果系统提供重置口令的功能，那么重置口令前必须先确认用户身份。重置口令需自动生成，不允许手工输入。参考“口令自动生成”。
管理员禁止重置自己的口令，只能修改自己的口令，且修改时需要验证旧口令。"
初始口令为系统提供的默认口令、或者是由系统管理员设定时，则在操作员/最终用户使用初始口令登录成功但在进入系统前，强制操作员/最终用户更改初始口令。如果用户不修改默认口令，不强制禁止用户登录，但是用户每次登录系统时应提醒用户修改口令，直到用户修改了默认口令为止。
"操作界面中的口令不能明文显示；键入的口令缺省不能在图形界面上明文显示；对于命令行场景，登录口令也不能明文回显。
系统禁止明文显示口令：
1）在登录界面或者修改口令界面中，禁止在界面上明文回显输入的口令；可以以如“******”等形式回显。
2）使用交互式命令行参数时，禁止在界面上明文回显输入的口令
3）禁止在程序的错误提示信息中明文显示口令
4）禁止在调试信息中明文显示口令
5）禁止使用查看历史命令（如：方向健或history）的方式显示口令
6）对于消费类产品（例如手机终端），可显示当前输入的字符或由用户选择是否显示键入的口令明文。
7）日志中禁止记录口令的明文或者密文，应用“*”等符号来代替对口令做匿名化。"
"口令输入框不支持拷出功能。
说明：
这里指的是不能从口令输入框“拷出”数据，能否“拷入”（粘贴）是不限制的。"
"口令不允许明文存储在系统中（如：数据库、配置文件、日志、cookie、调试跟踪信息中），应该加密保护。在不需要还原口令的场景，必须使用不可逆算法加密，推荐使用PBKDF2。

适用于：操作员帐号、程序帐号、最终用户帐号的口令。
说明：
口令不需要还原的场景（第三方及开源暂不要求）：
（1）在口令不需要还原的场景下禁止使用可还原的方法（如：对称加密）保存口令。
（2）禁止使用HASH(用户名||口令)、HMAC(用户名，口令)、HASH(口令 XOR salt)。
（3）HASH（salt||口令）可以作为遗留兼容老版本使用，但新开发的系统禁止继续使用。
（4）性能不敏感且无约束的场景下，必须使用不可逆散列PBKDF2算法保存口令，迭代次数缺省建议10000次。
（5）性能比较敏感（如：有大并发要求）的场景下，PBKDF2算法的迭代次数至少大于1000次
（6）认证凭据不需要还原的场景（例如认证端保存的用户登录口令），必须使用PBKDF2或公司密码学专家组认可的更强的算法加密，对于性能极其敏感且安全性要求不高的场景允许使用HMAC（口令，盐值）（注：口令、盐值位置可以互换）。
（7）PBKDF2不能使用公司规定的常见不安全hash算法(如：SHA0，MD2，MD4, MD5等)。
（8）系统存储口令时，必须确保不同用户使用不同盐值，盐值salt的长度至少8字节，且须使用安全随机算法生成。"
"
口令文件必须设置访问控制。"
"支持弱口令词典功能。
适用于：操作员帐号的口令。
说明：
口令不能是出现在指定弱口令词典中的词；每个业务提供并维护各自的弱口令词典。"
"产品出厂使用的第三方和开源软件禁止使用缺省口令。
说明：第三方和开源软件提供的缺省口令，特别是数据库帐号的缺省口令，已广泛公开并存在于口令破解工具的字典中，在现网中使用存在极大的安全隐患。禁用这些缺省口令能有效降低口令被破解的风险。
如果产品使用第三方和开源软件，必须将缺省口令进行替换，并且符合口令复杂度要求。"
"产品和服务部署到生产环境时需删除测试账号。
在生产环境使用测试账号需经两级申请审批，且严格限制权限和使用时间，使用时遵循4eyes原则，及时回收权限。"
"在 B/S 应用中，修改口令的帐号只能从服务器端的会话信息中获取，而不能由客户端指定。
说明：
禁止通过隐藏域或不可编辑输入框携带、提交待修改口令的帐号，以防止通过暴力破解方式修改其他用户帐号。

待修改口令的用户名或用户ID等禁止从请求报文里获取，应从服务器中的会话信息中获取。"
"对于系统内置账号的缺省口令，口令应符合复杂度的要求，如果不能满足口令复杂度则需要在用户首次登录时强制修改。
说明：
系统预置帐号的缺省口令（包括操作系统、数据库、业务系统），口令应符合复杂度的要求，如果不能满足口令复杂度则需要在用户首次登录时强制修改，客户明确定制的除外。"
机机账号的口令需支持强口令，至少包含16个随机字符
支持配置是否强制用户下次接入时修改口令

"使用Web开发框架（例如Java EE, ASP .NET and PHP）自身提供的会话管理功能。
1.B/S 应用中，只允许使用cookie方式维持会话，其他方式均不可以使用。

说明：使用Web开发框架（例如J2EE, ASP .NET and PHP）自身提供的会话管理功能，因为这些框架的会话管理功能是被广泛使用经受住安全考验的。对于J2EE来说，就是使用会话cookie来维持会话，当用户成功登录后，将用户名（或用户ID）保存到session对象中，以便在后继操作中明确当前会话对应的用户。
注意：
除特别说明外，会话及Session是广义的Web客户端跟服务端的通讯状态，不限定于编程语言的Session对象。"
"在 B/S 应用中，会话过程中不允许修改的信息，必须作为会话状态的一部分在服务器端存储和维护。
1、会话过程中不允许修改的信息，例如，当用户通过认证后，其用户标识在整个会话过程中不能被篡改。禁止通过隐藏域或URL重写等不安全的方式存储和维护
2、会话中的重要信息（如用户名、用户ID、用户权限等）必须存储在服务器端。
3、对于Session Id等必须在客户端存储的信息，服务器端须同样存储一份用于校验。
4、服务器端在鉴权及业务处理时，应该使用服务端的会话中存储的信息进行相关处理（如用户名、用户ID、用户权限等）。
5、服务器结合sessionid、IP地址以及其他的会话信息对每一个会话进行身份校验，判断该会话是否合法。
6、针对固定IP设备客户端，服务端应将Session id与设备IP绑定。"
"在 B/S 应用中，当 Web 应用跟踪到非法会话，则必须清除会话并返回到认证界面，同时需要记录安全日志。
说明：
非法会话的概念就是通过一系列的服务端合法性检测（包括访问未授权资源，缺少必要参数，输入参数明显被篡改过等情况），最终发现的不是正常请求产生的会话。例如：客户端和服务端采用同样的输入检验规则（比如，用户名长度<=10），攻击者通过工具绕过客户端的输入校验，提交了18个字符的用户名，这时在服务器端检验用户名的长度时发现异常（>10），就可以断定存在攻击行为，将该会话确定为非法会话，使该会话失效并重定向到登录界面，同时记录安全日志。"
"在B/S应用中，用户登录后，应重新分配Session，并作废登录前使用的Session。
"
"必须设置会话超时机制，在超时过后必须清除该会话信息。
1、设置会话超时时间,系统默认会话超时时间禁止设为永不超时，系统允许根据业务需求支持设定会话永不超时。系统默认会话超时时间应根据满足业务需求的最小值设定，建议为5~10分钟。产品中CLI以及管理接口也必须设定会话超时机制。
2、无特殊要求禁止使用自动发起请求的机制阻止session超时。
3、（可选）系统应实现会话固定超时机制和会话更新超时机制，减少会话被劫持的时间。

说明：设置会话超时时间，有利于减少会话劫持的时间窗。建议默认会话超时时间为10分钟（备注：对于嵌入式系统中的Web，建议默认超时时间为5分钟，以减少系统资源占用）。如果没有特殊需求，禁止使用自动发起请求的机制来阻止session超时。会话固定超时机制是指系统在创建会话时，设定了会话的最大可用时间；会话更新超时机制是指会话创建后经过指定的更新超时时间，由系统对当前的会话ID进行更新（系统创建新的会话ID，并尝试在用户客户端更新设定会话ID，当客户端使用新的会话ID后，原会话ID失效）。此方案作为会话空闲超时机制和固定超时机制一种补充机制，针对业务需求的超长时间会话超时场景较为有效。此机制可以减少攻击者劫持会话的时间。"
"认证通过后，给当前用户显示有关的访问历史记录数据，包括：
1、上一次认证通过的日期、时间和位置等信息；
2、上一次认证失败的日期、时间和位置等信息；
3、自从最后一次认证通过以来失败的尝试次数；
4、口令将到期的天数。"
1、界面必须提供主动登出机制，帐户从界面主动登出（指点击注销/登出按钮或输出退出命令）后，服务端必须立即清除会话。
"1、在 B/S 应用中，当用户退出时，必须清除该用户的会话信息。
2、对于C/S架构的场景，用户关闭客户端后，服务端必须立即清除会话；对于B/S架构的场景，用户关闭浏览器（而非从界面主动点击注销/登出按钮)后，允许服务端在超时后再清除会话。
3、服务端在间隔一定时间没有接收到来自客户端/浏览器的消息后，必须做超时登出，且清除维持的会话信息，另外对于有登录界面的产品来说，建议C/S架构的产品同时要返回到登录界面或锁屏，对于B/S架构的产品不强制要求要返回到登录界面。
说明：
1）对于客户端和服务端之间有持续握手、业务监控消息交互的场景，不要求服务端主动断开和客户端的连接。
2）产品可以提供安全的客户端锁屏机制，无法绕过锁屏机制对服务端进行有效攻击的场景可例外。
4、对于被删除的帐户，如果处于已登录状态，必须马上清除该帐户的session信息，后续的操作均无效。
说明：本条要求对于“所登录系统没有帐户管理功能的场景”可例外（如单点登录SSO的场景、系统利用外置帐户管理系统如Radius服务器进行帐户管理等），这是因为如果帐户管理功能在本系统外，那么删除帐户的操作在本系统无法感知。
5、异常退出场景下，可采用会话超时机制进行处理，在超时过后必须要清除该会话信息。
6、使用单点登录（SSO）系统的用户在用户退出（会话注销）时，要求SSO的portal和web应用中的会话和认证凭据都要销毁；
说明：
及时清除会话信息，能够减少黑客攻击时间窗，防止遗留在内存中的会话信息被窃取，减少内存占用。"
"系统提供限制同时登录在线用户数的功能，（德电要求）同一时刻只允许一个会话在线，该用户数可配置，当配置的用户数为 0 时，则表示不做限制。
说明：
指包括所有用户在内，允许的最大在线数可配置。"
系统提供能够根据帐号、组、角色与 IP 地址、时间范围进行组合来确定允许或拒绝会话建立的功能，系统是否执行该功能可配置。
"Web应用程序的会话标识必须具备随机性、唯一性；身份验证成功后，必须更换会话标识，以防止会话固定（session fixation）漏洞。
1、会话标识必须使用安全随机数算法生成。
2、会话标识有效长度不少于24个byte（或192bits）。
3、成功认证后必须更换会话标识。"
"1、会话cookie的属性要设置为HttpOnly。

说明：HttpOnly属性，用以阻止客户端脚本访问Cookie，当支持HttpOnly的客户端浏览器检测到Cookie包括了HttpOnly标志时，浏览器返回空字符串给企图读取该cookie的脚本，这样cookie中的任何信息暴露给黑客或者恶意网站的几率将会大大降低。"
"为cookie设置secure标志

说明：cookie的secure标志是应用服务器发送新cookie给客户端时的一个可选设置项，设置cookie的secure标志，用于指示浏览器只有在https（加密协议）下才能发送该cookie，禁止在http（明文协议）下发送该cookie，以防止cookie在http（明文协议）下被嗅探。"
"为包含会话标识的cookie设置适当限制的domain和path属性值。

说明： Domain（域），指定关联的WEB服务器或域，值是域名。"
"当服务端检测到客户端用户的IP信息发生了变化，应该强制销毁当前的会话，并要求用户重新登录。

说明：当服务端检测到客户端用户的IP信息发生了变化，说明会话很可能已经被劫持，应该强制注销当前的会话，并要求用户重新登录，以终止当前可能存在的会话劫持攻击。"
"1、任何重新认证或二次认证都需要生成新的会话标识。
说明：重要的交易/事务前，需要重新认证或二次认证，并且生成新的会话标识、使原来的会话标识失效，这样，即使重新认证或二次认证前的会话被劫持了，也可以在重新生成会话标识后终止会话劫持，减小会话劫持给用户带来损失。

2、用户权限变更的场景（用户修改密码、用户角色或权限变更等）,建议产品销毁当前用户账号的所有会话。"
"对客户端提交的表单请求进行合法性校验，以防范CSRF攻击。
1、token必须使用安全随机数生成。
2、token长度必须不少于24byte（或192bits）。
3、token最长有效期必须小于或等于会话有效期。
4、B/S架构中，token必须存在于页面表单隐藏字段或自定义HTTP header。
5、对于系统敏感和关键操作，如：数据的添加/修改/删除/上传以及开关配置等，请求必须要使用token防止csrf攻击。
说明：使用Token防止CSRF攻击，优选方案为每次提交请求后Token要更新一次；至少要做到在每次会话创建时生成新的token。
说明：使用防跨站请求伪造标识（CSRF_TAG）对敏感或关键的操作进行校验，CSRF_TAG必须使用安全随机数算法生成、有效长度不低于24个字符，且需要设置有效期。

CSRF_TAG是服务器为确认客户端请求的有效性，防止跨站请求伪造攻击（跨站请求伪造攻击是攻击者诱骗用户去执行攻击者预先设置的操作）而随机生成一段字符串。客户端发起的敏感或关键的操作（如：支付操作、修改密码操作、添加修改管理员操作、重启设备操作等）必需使用CSRF_TAG验证请求的有效性。CSRF_TAG通常与Session Id一起使用，来验证用户身份，以确保客户端提交的请求是用户主动发起，而非攻击者伪造的请求。

B/S架构中建议在页面的表单或head中使用隐藏字段传输CSRF_TAG。

禁止Browser使用Html<script>元素的src属性从服务端获取javascript脚本的方式获取会话Token，此种方式不受同源策略保护，易造成会话Token被盗用。例如，通过xxxx.js脚本从服务端获取会话Token，<script src=""....\xxxx.js"">。"
"SSO的认证票据（authentication ticket）方案：用户登录基于认证票据的SSO系统后，用户访问SSO系统中的web应用时，SSO产生认证票据作为用户的身份认证凭据。
采用此方案时，应防止重放攻击和未授权使用问题。
1、认证票据只有用户在访问系统中某web应用时才能创建，且该票据的有效时间应该尽量短（根据业务需求，有效期应设定在10秒~5分钟以内）。
2、认证票据创建时要强关联到具体某Web应用。
3、认证票据只能使用一次，使用完毕后，无论是否校验正确都要作废该票据。"
"防止攻击者通过其他途径获取会话标识

1、禁止将会话标识符以GET参数进行传递。
2、禁止在日志或打印信息中暴露会话标识，如需打印，需进行不可逆处理（如：hash、使用*替代）。
3、禁止在url中包含会话标识。"

"对于人机接口或跨信任网络的机机接口的登录认证必须支持口令防暴力破解机制，当重复输入错误口令次数(如3次）超过阀值时采取合适保护措施。保护措施可参考：
1）锁定帐号；
2）锁定IP；
3）登录延迟；认证间隔时间依次加倍，采用这种方式时，用户可以不设置自动锁定。
4）验证码；
5）超长口令+IP白名单+告警或日志。

服务端锁定一个帐号后，在解锁之前，该帐号不能登录系统；服务端锁定一个 IP 后，在解锁之前，由该 IP 发起的登录请求都不能成功。
a、对于人机接口推荐选择：验证码、锁定帐号或IP或认证延时等；对于人机登录的场景，不能使用“超长口令+IP白名单+告警或日志”的方式来防暴力破解
b、对于跨信任网络的机机接口推荐选择：锁定IP、口令+IP白名单+告警或日志的方式。

由于验证码的防暴力破解的能力较弱（我司产品的验证码功能，几乎都能被自动化软件所识别），所以要求在高风险场景下，不能仅使用“验证码”作为口令防暴力破解的方法，必须结合“锁定帐号”、“锁定IP”、“登录延迟”中的一种来防暴力破解。
帐号/IP锁定机制不能以单次会话来判断暴力破解攻击，要基于IP或者账户来判断攻击，而不是基于会话。"
"连续登录失败锁定策略的“限定的时间段”可配置，取值范围：0-999 分钟，当取值为 0 时，表示该时间段为无限长，建议默认：10 分钟。
适用于：管理员账号，操作员账号，最终用户账号。
说明：
这是对“连续登录失败锁定帐号”的补充，使用“锁定账号”方案时必须配套实现。
该“限定的时间段”的计算方法：当检测到登录失败时，此时刻为该时间段的截止时间，起始时间则是该时刻往前 n 分钟。"
"连续登录失败锁定策略的“允许连续失败的次数”可配置，取值范围：0-99 次，当取值为 0 时，表示不执行锁定策略，建议默认：3 次。
适用于：管理员账号，操作员帐号、最终用户帐号。
说明：
如果已经通过验证码防止帐号口令的暴力破解，那么，不强制遵循本条要求。
这是对“连续登录失败锁定帐号”的补充，使用“锁定账号”方案时必须配套实现。
允许连续失败的次数指从最后一次登录成功以来登录失败的次数的累计值。"
"锁定时长可配置，取值范围：0-999 分钟，当取值为 0 时，表示无限期锁定，建议默认：30 分钟。
适用于：管理员账号、操作员帐号、最终用户帐号。
说明：
如果已经通过验证码防止帐号口令的暴力破解，那么，不强制遵循本条要求。
这是对“连续登录失败锁定帐号”的补充，使用“锁定账号”方案时必须配套实现。"
"连续登录失败锁定策略执行并在锁定时间超时后，系统支持自动解锁功能，同时支持管理员手动解锁功能，并提供管理员对服务器锁定其它用户帐号或者 IP 进行解锁的功能界面。
说明：
这是对“连续登录失败锁定帐号”的补充，使用“锁定账号”方案时必须配套实现。
如果已经通过验证码防止帐号口令的暴力破解，那么，不强制遵循本条要求。
适用于：操作员帐号、最终用户帐号、管理员账号。"

"在 B/S 应用中，对于每一个需要授权访问的请求，必须核实用户的会话标识是否合法、用户是否被授权执行这个操作。
1、Web server必须对访问的请求进行过滤。普通用户禁止通过http访问/web/web/路径下任意文件(日志、配置文件）。
2、禁止不登录WEB界面即可获取系统配置信息。
3、刀片服务器WEB禁止不经认证通过http（非https）协议访问下载conf和xml文件。
4、管理web的所有url必须经过认证，防止泄露关键数据。
5、针对批处理操作的场景，鉴权模块应以提交批处理文件的用户作为鉴权对象，对批处理文件中的每一条命令进行鉴权，以防止越权执行命令。
6、对URL进行鉴权（如匹配白名单）时要严格，避免鉴权被绕过（如URL尽量使用全匹配，不能使用简单的包含某个字符串的匹配算法，对URL里面的""../""类目录操作相关字符要进行过滤）。
说明：
越权包括纵向越权和横向越权；不允许用户越权访问其他用户的数据。
1、横向越权，例如：部门经理A和B分别只能查看部门A和B内部人员的信息，部门经理A查询部门人员A1的信息，提交的参数包含A1的工号A001，这时，部门经理A将A001改为B001（部门B的员工工号），越权访问B部门人员的信息。
应用受理这类请求时，通过SQL的where条件语句，判断操作请求者和被操作对象间的从属关系，从而防止横向越权。
2、纵向越权，例如：普通用户A和管理员B，普通用户能够通过非正常渠道篡改其权限，提升权限，达到越权访问管理员B的权限数据。"

"禁止存在可绕过系统安全机制（认证、权限控制、日志记录）对系统或数据进行访问的功能。
说明：
1、禁止通过连接特定的物理或逻辑端口绕过认证，直接进入系统。
2、禁止通过特定的客户端绕过认证，直接进入系统。
3、禁止设计特殊的URL绕过认证，直接进入系统的功能。"
" 禁止隐秘访问方式：包括隐藏账号、隐藏口令、无鉴权的隐藏模式命令/参数、隐藏组合键访问方式；隐藏的协议/端口/服务；隐藏的生产命令/端口、调测命令/端口等。
说明：
禁止存在空口令，即使实际环境中不使用。
说明：
1、禁止使用特定的组合键（如：ctrl+D键）绕过认证（如：不用输入口令）直接进入系统。
2、禁止使用特定的鼠标操作绕过认证（如：不用输入口令）直接进入系统。"
"禁止不可管理的认证/访问方式：包括用户不可管理的帐号，人机接口以及可远程访问的机机接口的硬编码口令等。

系统禁止存在用户无法修改的口令。对于出厂时缺省设置的帐号/口令，产品须提供客户修改机制，在产品CPI资料中应提醒用户修改及定期更新，并提示风险：
1、应在产品CPI资料中提示用户修改出厂时预置的缺省口令。
2、人机帐号使用缺省口令登录时，系统应提示用户修改缺省口令。
3、管理员重置用户口令（如：找回密码功能）后，用户登录系统时应被提示修改重置口令
4、如果产品调用开源第三方软件，且开源第三方软件无法实现提示用户修改口令的功能，应在产品资料里提醒用户更新口令
5、口令禁止硬编码在代码里，但对于用于出厂设置的缺省口令不强制要求。对于缺省口令硬编码的场景，应满足“子检查项6”的要求。
6、在服务端读取口令失败的情况下（如存储口令的配置文件损坏），系统禁止自动启用缺省口令。
7、SNMP v2c必须具备分别配置读团体名、写团体名和Trap操作团体名的功能。
8、SNMP v3必须具备分别配置鉴权密码和加密密码的功能。（请参考RFC2274）"
"未文档化的命令/参数、端口等接入方式（包括但不限于产品的生产、调试、维护用途），需通过产品资料对客户公开或受限公开。

受限公开是指依据与运营商的协议或所在国家法律法规要求而提供。
2.1 对于现网维护期间不会使用的命令/参数、端口等接入方式（包括但不限于产品的生产、调测、维护用途），必须删除（如通过编译宏）。
2.2 对于需在现网维护阶段使用的命令/参数、端口等接入方式（包括但不限于产品的生产、调测、维护用途），需通过产品资料等向客户或监管机构公开或受限公开。
对于命令/参数公开或受限公开的更多说明，请参考“说明”页签中“未公开接口”一项。"


"系统采用基于角色的帐号权限管理模型。
说明：系统采用基于角色的权限管理模型进行授权。

说明：可以使用“三员分立”角色权限模型，保证三类角色权限能相互独立，相互制约，安全管理员与安全审计员不得由一人兼任。
"
"新建帐号如果没有配置权限等级或权限等级未生效时，默认不授予任何权限或者默认只指派最小权限的角色。
说明：防止授权机制出现问题或授权机制被绕过时用户的获得权限也是最少的，以尽可能减少出现问题时系统遭受的风险。"
"运行软件程序的帐号不能是操作系统最高权限的帐号，只能是一个分配最小权限的操作系统帐号。
说明：
1、对于运行应用系统的操作系统帐号，不应使用“root”、“administrator”、“supervisor”等特权帐号或高级别权限帐号，应该尽可能地使用低级别权限的操作系统帐号。
2、属于低权限用户的脚本或程序不能以高权限帐号运行，且只有其文件属主才拥有写权限；可执行程序的文件的写权限只能让运行此程序的用户中权限最高的那个拥有。(例如 rwx*-**-*)，属于非root用户的程序文件不能以root帐号运行。"
"连接数据库系统的帐号不能是数据库系统最高权限的帐号，只能是一个分配最小权限的数据库系统帐号。
说明：
对于连接数据库服务器的数据库帐号，不应使用“sa”、“sysman”等管理帐号或高级别权限帐号，应该尽可能地使用低级别权限的数据库帐号。"
"授权和用户角色数据必须存放在服务器端，不能存放在客户端，鉴权处理也必须在服务器端完成。禁止仅在前台对窗口控件做灰化或仅前台屏蔽操作页面，防止任意用户可在登录后通过直接构造并发送请求报文，绕过前台的限制。
说明：禁止将授权和角色数据存放在客户端中（比如cookie或隐藏域中），以防止被篡改。"
"系统涉及到的目录和文件(包括运行过程中产生的临时目录和临时文件)只能分配最小的权限。
说明：
1、系统需要严格限定目录和文件的权限；特别地，当文件包含敏感信息时（例如，包含敏感数据的配置文件、日志文件、个人敏感数据文件、用户口令文件、密钥文件、证书文件、驱动文件、备份文件）必须要有权限控制，只允许文件的属主或需要访问该文件/目录的用户拥有相应的权限。具体可以参考《身份和访问管理安全设计规范v2.0》中设计样例《Unix/Linux文件目录权限设计》。系统自身没有能力控制文件权限的除外。
2、从外部文件读取数据并执行时要严格限制外部数据文件的修改权限，防止注入攻击；如当前命令输入文件的文件权限须设为600或700，且属主为运行当前程序的OS帐号
3、Unix和类Unix系统用户的umask须被设置成027或更大。
4、向第三方开放API功能，或者接受第三方进行应用开发或业务定制的系统，须能够对第三方调用者的权限进行限制，对可能会对系统机密性、完整性和可用性造成影响的API进行权限控制。"
"目录、文件的创建以及权限的分配自动完成。
说明：
如在安装程序（或者安装脚本）中自动完成。"
"客户端软件运行时调用的外部程序不允许为BAT脚本类型，有数字签名手段防范脚本篡改的可以例外。

说明：客户端软件调用一个来自外部的bat脚本，容易被攻击者篡改导致提权攻击。"
"应用系统中，创建的用户不能给自己增加的权限。
说明：
1、低权限用户创建一个新用户，通过新建的用户不能为自身增加权限。
2、新建的管理员不能增加自身没有的权限。
3、对于一些高风险命令（如vi，chmod，chown，cp，passwd，rm，mv，useradd、groupadd、scp 等，参考Linux安全配置规范中的附件《Sudo安全配置指导书》）使用sudo时必须限制其命令参数，即在配置/etc/sudoers时必须将命令参数（如需要操作的具体文件名、路径、用户名）带上。"
"1、禁止系统中ftp/sftp用户向上跨目录访问，用户只能访问指定目录下的文件。后台通过ssh登录进行管理维护操作并需要文件传输的情况例外。
2、用户通过http/https上传文件时，文件的类型、大小、路径必须在服务端进行校验，文件类型的校验至少要对扩展名进行校验。通过http/https下载文件时必须在服务端对文件路径进行校验。如果对上传的目录做了存储空间限制，不强制要求再做文件大小校验。如果业务确实需要上传任意文件，可以不校验文件类型，但禁止上传到web内容目录。

说明：
1、上传下载时，如果不限制用户对目录的访问，不对上传或下载的文件的属性进行控制，可能导致各种安全问题，包括：信息泄露、越权访问、上传和执行恶意代码。
2、服务端在存储上传的文件时，使用单独的目录存放，属主设置为运行程序的帐号，仅属主可读、可写。Linux下可设置为600。即使文件上传功能存在漏洞，攻击者可以上传恶意代码，如Webshell，由于上传的文件没有执行权限，攻击者也无法执行恶意代码，可以限制文件上传漏洞对整个系统的影响。"
"对于应用系统内可降低系统安全特性、可查看敏感信息或可提升权限的危险命令或程序应只允许系统内高权限用户（如管理员）才能执行。禁止未授权的帐号执行关闭数字证书校验、重启系统等高风险的操作。

检查系统内的高风险命令（非操作系统命令）是否只能被少数用户（如管理员帐号）调用，如果普通用户都能调用则不满足要求。

1、低级别用户禁止查看（如通过display this命令）认证凭据、管理员配置的加密密码等敏感内容。
2、低级别用户禁止删除、创建和禁用高级别的管理员
3、低级别用户禁止通过命令重置高级别管理员（如：超级管理员admin）的密码。
4、系统中的敏感的操作（如：关闭完整性校验等系统安全特性、debugging、复位重启命令等）要有严格的权限控制，只允许相应级别的用户才有权限执行。
5、（可选）低级别用户禁止查看高级别用户的登陆、在线情况、日志等信息。"
权限的设置要支持3级审批模型
提供两个安全管理员（一个用于修改权限，一个用于审批修改），两个安全管理员之间的权限需要隔离
提供两个业务管理员，根据业务交易职责，分离业务权限（一个用于输入，一个用于验证）
说明：客户端软件调用一个来自外部的bat脚本，容易被攻击者篡改导致提权攻击。

"禁止在代码中存储明文的口令、密钥、银行帐号等敏感数据。
说明：
禁止在代码中存储如数据库连接字符串、口令等的敏感数据，这样容易导致泄密。
例外：根密钥（请参考“说明”中的名词解释）不遵循该规则，但必须遵循本基线中“加密解密”相关的要求。"
"认证凭据不允许明文存储在系统中，应该加密保护。
说明：
1、密钥、银行帐号、身份证号码也属于不能明文存储的敏感数据。
2、SessionID禁止明文在本地（数据库、磁盘等）存储，加密或采用掩码方式保存均可。对于业务需要本地储存且加解密性能受限的场景可例外，如Redis。

认证凭据包含“口令”；即使是内存中的明文口令（如登录期间），也应在使用后立即覆盖；禁止将敏感数据以明文形式存储在数据库或者文件中。
专门针对口令要求见“SEC-APP-Password-15”。
专门针对密钥要求见“SEC-APP-Cryptography-09密钥不能明文存储”。
敏感数据的定义请参考“说明”中名词解释。"
"对敏感数据的访问要有职责分离的访问控制机制。
说明：
管理员账号只能给操作员账号，最终用户账号分配业务权限，不能给自己分配业务功能权限/数据权限，不能操作业务功能。"
"禁止在任何日志中打印明文的口令、银行帐号、身份证号码、原始通信内容。
说明：
1、跟踪的消息不能包含以上敏感数据；系统向自然人发送的业务短信、收费业务的“金额”不能打印。
2、如加密算法、IV值、密钥等信息也不能打印。"
"1、界面的错误提示或返回给客户端的错误提示报文中禁止包含服务端的堆栈、数据库名/表名等系统敏感信息。建议设计统一的异常处理机制（例如对于web访问，可以设计统一的异常返回页面），避免异常时打印敏感信息到客户端。
2.禁止在日志中打印堆栈信息。
3、URL中禁止存放Session ID、非一次性认证票据（如TGT）等敏感信息。
4、禁止在操作界面、日志、调试信息、错误提示中明文打印口令、密钥、银行账号、会话标识、身份证号码、原始通信内容等敏感信息。例外场景如下：
（1）黑匣子日志的场景例外；
（2）消费者终端类产品，可根据业界惯例可选明文显示；
（3）wifi ap接入口令，可根据业界惯例可选明文显示；
（4）明文查询业务口令/密钥可例外"
禁止在日志和告警信息中包含密文的口令、银行帐号、身份证号码、原始通信内容。
"在 B/S 应用中，禁止在 cookie 中以明文形式存储敏感数据。

说明：cookie信息容易被窃取，尽量不要在cookie中存储敏感数据；如果条件限制必须使用cookie存储敏感信息时，必须先对敏感信息加密再存储到cookie。会话cookie中的SessionID除外。"
在 B/S 应用中，禁止在隐藏域中存放明文形式的敏感数据。
"在 B/S 应用中，禁止带有敏感数据的 Web 页面缓存。
说明：
带有敏感数据的 Web 页面都应该禁止缓存，以防止敏感信息泄漏或通过代理服务器上网的用户数据互窜问题。"
"在 B/S 应用中，敏感数据必须使用 HTTP-POST 方法提交。 

说明：
禁止使用 HTTP-GET 方法提交敏感数据（比如密码），因为该方法使用查询字符串传递表单数据，容易导致敏感信息泄露。
"
"在非信任网络之间进行敏感数据（包括口令，银行帐号，批量个人数据等）的传输须采用安全传输通道或者加密后传输，有标准协议规定除外。
说明：
在系统设计时，需识别出产品敏感数据。
口令，银行帐号，批量个人数据等敏感数据如需通过非信任网络传输，产品应支持安全传输通道或者将数据加密后再传输的机制。有标准协议规定除外。（“标准协议”的定义请参见“术语定义”页签）。

说明：
1、对于仅在认证阶段使用加密/加密隧道传输口令，业务数据使用明文传输的场景，修改或重置口令时，必须切回加密/加密隧道传输口令，确保口令不会明文传输。
2、非信任网络中传输的对称密钥、共享秘密（如：预置共享密钥、PBKDF中的口令等）须进行完整性保护（如：使用MAC或签名算法）。"
"在不可信网络中传输敏感数据时，必须采用HTTPS安全协议。
说明：
1、禁止使用SSL2.0和SSL3.0协议
2、TLS1.0仅在向下兼容、第三方对接等场景下可遗留使用
3、如客户明确要求不支持HTTPS的，需先提出解决方案，向架构组和IT部申请备案，审批后方案实施。"
"在 B/S 应用中，禁止在 URL 中携带会话标识（如 jessionid）。
说明：
由于浏览器会保存 URL 历史记录，如果 URL 中携带会话标识，则在多人共用的 PC 上会话标识容易被其他人看到，一旦该会话标识还在其生命有效期，则恶意用户可以冒充受害用户访问 Web 应用系统。"
"禁止将对用户保密的信息传送到客户端。
说明：
这些信息一旦传送到客户端，那么用户也就可以获取到了。"
"防止代理服务器强制缓存带有敏感数据的 Web 页面
说明：
通过在页面代码中增加禁止缓存的指示代码，对采用强制缓存策略的代理服务器不生效（代理服务器默认是不缓存的），因此，如果要彻底禁止敏感信息页面被缓存，必须通过url中带随机数来解决。"
"在非信任网络之间进行交易过程数据的传输须采用安全传输通道或者加密后传输。
说明：
交易过程数据是指在订购、付费、退款等过程中产生的数据。
优选HTTPS方案，如客户明确要求不支持HTTPS的，需先提出解决方案，向架构组和IT部申请备案，审批后方案实施。"
敏感数据(如public SSH keys)需有防护、监控、审计措施，即一旦被非法修改能够被检测到
"敏感数据保护
• 发送到客户端的敏感数据的所有拷贝(临时的或缓存的)须防止被非授权访问；在授权访问完成后要清除或使敏感数据拷贝失效"

"数据控制者必须在客户资料或界面中提供隐私声明，设备供应者必须在产品资料中提供产品处理的个人数据说明
1、对于数据控制者，涉及个人数据处理的产品或服务必须在产品客户资料中提供个人数据说明或产品界面中提供产品隐私声明，隐私声明内容必须完整。
2、以华为名义直接向数据主体提供的产品或服务时，提供的隐私声明必须经过法务部批准，提供的隐私声明应易于用户随时找到，在web产品页面或是界面上提供隐私声明或隐私声明的链接。
3、对于设备供应者，必须在产品资料中提供产品处理的个人数据说明。
4、设备供应者需要按照数据控制者的要求提供向数据主体提供隐私声明的机制。

业务场景说明:
1、传统交付运营商业务场景：该场景通常属于设备供应者，适用以上3、4的要求；
2、以华为名义提供给租户的软件SaaS自运营业务场景：该场景中，华为向租户提供服务且采集租户的个人数据，但不控制最终用户个人数据，则通常属于设备供应者，需要向租户提供隐私声明，适用以上2、3、4的要求；
3、以华为名义提供给最终用户的软件SaaS自运营业务场景：华为既提供软件服务也控制最终用户的数据（类似vmall），则华为属于数据控制者，适用以上1、2的要求。
说明：
所有提供给运营商或企业客户的产品，若产品提供正常业务时涉及个人数据（包含收集、使用、转移、存储等），必须在产品客户资料中提供个人数据说明或产品界面中提供产品隐私声明，描述产品收集的所有个人数据类型、目的、处理方式、时限，数据控制者提供的隐私声明(Privacy Policy)，应易于用户随时找到。"
"隐私声明必须包括以下信息：
1、数据控制者需提供数据控制者的身份信息和联系方式；
2、处理个人数据的目的；
3、个人数据的存储期限或决定存储期限的标准；
4、数据主体享有向数据控制者请求访问、更正、清除个人数据的权利，限制、拒绝处理个人数据的权利以及可携带权；
5、数据主体有权随时撤销同意；
6、向监管机构投诉的权利；
7、自动化决策（包括识别分析、用户画像）及可能对数据主体造成的后果。
8、如果数据控制者向另一个国家或者国际组织转移数据，应给出获取个人数据或其副本的方式和相应的安全保障措施。"
"对于数据控制者和处理者涉及到修改用户隐私空间的行为，须得到用户的同意。
1、对于如果不升级则无法正常使用的产品，升级时仍然要给用户提示，在提供给用户确认选项时，可以只提供用户同意的选项。
2、对于没有UI的设备或符合业界惯例情况，可以在用户使用手册或协议中说明升级的相关事宜。
3、对于终端类产品，涉及软件下载功能时，需要默认关闭下载功能，并提供用户手动开启下载的选项。另外，为了提升用户体验，可以提供是否允许自动下载的选项。针对没有UI界面的产品，不允许提供下载应用软件的功能，其中OTA升级的升级包除外。
4、对于智能手机、平板等产品，对系统或软件升级时，必须给用户提示，并提供给用户同意和取消的选项，在用户同意后才启动升级，用户也可以选择不升级。
5、对于蜂助手为产品提供维保服务，而且获得客户（如运营商等）授权的场景，不在此要求范围内。
说明：
1.数据控制者和处理者对系统或应用配置变更、产品下载软件、对用户系统或软件的升级都属于可能修改用户隐私空间的行为，对于这类行为，用户需要有知情权和控制权，必须给用户提示，并提供给用户同意和取消的选项，在用户同意后才能修改（用户主动发起的操作除外）。
2.客户端与服务器自动协商的参数（如通信协商过程），不在此规则要求范围内。云业务服务器的配置如果不涉及个人数据的变更，不需要得到用户的同意。
3.对于销售给客户，蜂助手不参与运营，蜂助手既不是数据控制者也不是数据处理者的场景，不在此要求范围内。"
"直接面向数据主体并提供界面的产品获取用户同意时，同意须要求用户有明确动作：
1、提供界面获取用户同意的产品，需要保证同意是经过数据主体的主动点击（即明示同意），获取用户同意时，使用默认勾选或者忽略问题不能构成同意。
2、若通过配置开关来获取用户同意，需将用户的同意持久化保存，如保存在数据库或配置文件中。避免重启或升级的场景造成同意丢失。"
"收集或使用个人数据前，须明确提示用户，并获得用户的明示同意，并且允许用户随时关闭对个人数据的收集和使用
1、未经数据主体同意，数据控制者不允许私自收集其个人数据（如MSIDN、IMSI、IMEI、URL HOST、URI等）。
2、数据控制者采集的个人数据必须在隐私声明里说明或是在收集之前通过弹出框告知数据主体。
3、数据控制者必须向数据主体提供授权及撤销授权的机制。
4、（可选）消耗用户流量的操作第一次联网前须获得用户同意，防止被质疑为恶意消耗用户流量。
5、系统或特性的默认设置应保护隐私，例如手机端应用自动检查更新设置默认关闭、不再提醒的提示框为默认不勾选、开启云服务功能默认不开启等。
6、收集敏感个人数据（敏感个人数据定义参见术语定义）必须获得用户明示同意（明示同意定义参见术语定义）。
7、对于数据处理过程中生成的数据（如信用和购买记录等），也须作为个人数据对待，因此收集这类衍生数据须获得用户同意（同意定义参见术语定义）。
8、对于存在从第三方获取个人数据的场景，数据控制者需要向数据主体提供通知，通知内容包括处理个人数据的目的、相关个人数据的种类、个人数据的来源，是否来自公开渠道、数据主体有权随时撤销同意。
9、用户同意在其有效期内长期有效，因此在同意的有效期内，不必再次获得用户同意。但同意有效期不宜过长，建议可以参考业界最佳实践。比如法国CNIL规定用户对使用Cookie的同意的有效期是13个月，超过这个时效期需要重新获得用户同意。
10、对于设备供应者，产品若无法向数据主体提供获取数据主体同意的机制，不强制要求提供获取数据主体同意的机制。
如果客户提供了明确的需求，或者按照业界惯例提供了相应机制，或者产品分析认为不提供获取数据主体制授权的机制隐私风险高，产品须在设计时提供收集个人数据获取数据主体同意的机制。具体实现方式可以参考1-9条子检查项的要求。
对于设备供应者，若数据控制者有其它获取数据主体同意的方式，如：运营商开户的IPTV产品、企业用户开户的IP话机产品，或为了满足公共利益、公共安全或处理紧急事务的产品，不强制要求产品提供收集数据主体明示同意的机制。
11、对于设备供应者提供正常业务时涉及第三方获取的个人数据（包含收集、使用、转移、存储、销毁），必须在产品资料中提供产品处理的第三方个人数据说明，描述产品处理的所有个人数据类型、目的、处理方式、时限、风险和建议。
12、直接面向数据主体的产品，如果需要收集数据主体的个人数据，则需要提供收集数据主体明示同意的机制。

说明
1、对于数据控制者，必须在数据收集之前告知数据主体并获得其明确的同意，并且还需要向数据主体提供撤销或修改同意的途径。为了履行政府授予数据控制者任务等法律允许的情况例外（如司法调查）。可以使用书面合约/合同、邮件、信件、传真、短信确认/ DTMF按键信息、语音提示确认、电子合约（主要是Web类应用）等方式获得用户的授权，用户也可以使用以上方式取消授权。
用户同意在其有效期内长期有效，因此在同意的有效期内，不必再次获得用户同意。但同意有效期不宜过长，建议可以参考业界最佳实践。
需要在产品资料或界面告知用户撤销或修改同意的方式，以及撤销同意之后对于提供服务的影响。
2、对于设备供应者，需根据业务需要以及风险等级来确定是否需要提供获取用户授权的机制。





"
"对于数据控制者，如在数据主体系统上运行的应用软件需要连接到互联网，数据控制者须在连接前告知数据主体，并提供获得数据主体同意的机制。
1、运行在数据主体系统上的应用软件连接至互联网之前，在UI界面必须提供明示同意的选项并获得用户明确同意。
2、对于数据控制者，如产品无操作界面，则应在产品资料中明确说明程序会连接至互联网

说明：
应用软件类产品在连接到互联网之前，必须向数据主体提供获取同意选项框，让数据主体自主决定是否同意连接互联网。
如果产品没有界面，需要在产品资料中向用户说明程序会连接至互联网。
对于设备供应者，产品应在设计时提供相应的通知数据主体并获取数据主体同意的机制。"
"对于数据控制者和设备供应者，在从数据主体系统中传出包含个人数据的错误报告之前，必须提供机制告知数据主体，并获得其明示同意。
1、传出包含个人数据的错误报告前，必须在UI界面提供明示同意的选项并获得用户明确同意。
2、对于数据控制者，如产品无操作界面，必须在产品资料中明确告知用户会传出包含个人数据的错误报告。

说明：
在应用程序崩溃需要发送错误报告之前，必须向数据主体提供明示同意选项，让数据主体自主决定是否同意发送错误报告。针对无操作界面的产品，需要在资料中给出明确的声明。
"
"对于数据控制者，若需要将个人数据用于营销、用户画像、市场调查，数据控制者和设备供应者必须提供机制提前单独获取数据主体明示同意，并提供随时撤销同意的机制
1、对于数据控制者，收集个人数据用于营销、用户画像、市场调查前，必须获得数据主体的明示同意。
2、对于数据控制者，必须保留数据主体同意的证据、时间。
3、数据控制者必须向数据主体提供撤销同意的功能。
4、数据主体选择退出营销活动，其个人数据（例如，手机号、邮箱）将不能再用于营销及为营销目的而做的画像。
5、销售到欧盟的产品或系统，涉及用户画像（user profile）和营销时，除了要告知用户有否决权，而且需要通知用户个人数据是否转出EEA、用户画像的逻辑、拒绝提供个人数据的后果。
6、直接面向数据主体并提供界面的产品，如果系统对用户提供了直接营销功能（例如通过邮件或者短信进行营销），需要在界面上提供单独的同意选项获取用户的明示同意。同时，产品应为用户提供撤销同意、退出营销行为的机制，如：点击退订链接、回复退订短信、点击不同意按钮，或者是向隐私声明中预留联系方式发申请。
7、对于设备供应者，由于有些场景通过产品无法直接向数据主体提供获取数据主体同意以及随时撤销同意的机制，或是客户决定通过其他方式提供该机制，因此不强制要求满足该条规则；但是如果客户提供了明确的需求，或者按照业界惯例提供了相应机制，或者产品分析认为不提供该机制隐私风险高，产品须在设计时提供相应的获取数据主体同意以及随时撤销同意的机制。
说明：
当数据控制者收集用户个人数据用于营销、用户画像、市场调查时，应让用户自由选择是否同意将自己的个人数据用于营销、用户画像、市场调查的目的。必须保留用户给出同意的证据，并且记录用户给出同意的时间。并且必须向数据主体提供随时撤销同意的机制。一旦数据主体表明不再想接收营销信息，要立即停止对其营销。
对于设备供应者，需根据业务需要以及风险等级来确定是否需要提供获取用户同意以及随时撤销同意的机制。

目的和意义：
防止未经用户授权将用户数据用于营销、用户画像、市场调查等，给予用户选择是否同意以及撤销同意的权利，避免违反法律。"
"对于数据控制者和设备供应者，除了法律允许的情况以外，在设置或读取在数据主体系统上的Cookie前（如用于营销或广告），应提供获取数据主体同意及撤销的机制。
1、在数据主体系统上设置或读取Cookie前，必须提供机制告知数据主体并获得其同意。
2、数据主体同意前，禁止使用Cookie。
3、应向数据主体提供拒绝使用Cookie的功能。
4、数据主体撤销同意之后，不允许继续使用Cookie，且数据主体系统上的Cookie必须被删除。

说明：
当网站在用户设备上设置Cookie来分析用户行为，向用户营销、推送广告或是进行市场调查时，必须在设置Cookie之前询问用户是否同意。在获得用户同意前，不得使用Cookie。并且应该向数据主体提供机制来拒绝使用Cookie。
在以下场景中使用的Cookie可以不需要获得用户的同意：
1) 用户输入Cookie（session-id），会话生命周期内有效或在某些情况下有效期为几个小时的持久性Cookie
2) 会话期间用于认证服务的认证Cookie
3) 用于维护用户安全的认证Cookie
4) 会话期间内有效的多媒体播放器会话Cookie，例如flash播放器Cookie
5) 会话期间内有效的负载均衡会话Cookie
6) 会话期间用于个性化设置UI的Cookie
7) 针对社交网络已登录用户的第三方社交插件内容共享Cookie
"
"默认禁止收集数据主体的敏感个人数据，除非业务必需（如：运动健康类业务）或为了满足法律与监管机构要求可收集和处理（含profiling），并且同意应该单独收集

1、默认禁止收集数据主体的敏感个人数据，除非业务必需（如：运动健康类业务）或为了满足法律与监管机构要求可收集和处理（含profiling）。
2、收集数据主体的敏感个人数据的同意需要与其他普通个人数据的同意区分开。
3、产品发往国家禁止处理相关敏感个人数据时，即使获取了数据主体的同意也不能处理这些敏感个人数据。（法务部确认国家要求）

说明：
敏感个人数据中的种族、政治观点、宗教和哲学信仰、工会成员资格、基因数据、生物信息、健康和性生活状况、性取向等，以及可与自然人身份相关联的银行卡号、身份证号、护照号、口令等。上述个人数据的同意需要与其他普通个人数据的同意区分开，例如在收集和使用敏感个人数据前提示数据主体并获得同意。
注意：需要根据产品发往国家的法律规定来执行（欧盟或成员国法律可能规定禁止处理上述的个人数据，而不取决于数据主体的同意）
"
"在正常业务流程和标准协议之外，禁止出于故障定位目的进行用户精确位置信息定位。在运营商提供增值服务时，如需处理用户精确位置数据，应获得运营商的授权，并在方案设计时，给予最终用户随时撤回同意的机会。
特定国家法律不禁止的情况下，可以对销售往该国的产品定制开发。"
"对未成年人提供服务或收集了包含年龄信息的个人信息时，需要实现从未成年人的监护人处获取同意的功能
1、对未成年人提供服务或者收集了包含年龄信息的产品，需要建立识别数据主体的年龄的方法。
2、对未成年人提供服务或者收集了包含年龄信息的产品必须提供从家长处获取同意的机制。
3、系统需严格根据交付国家法律判定未成年人。

说明：
如果产品在收集个人数据时，包含年龄信息，需要实现从未成年人的监护人处获取同意的功能。法律对处理未成年个人数据也有更严格的要求。因此产品应采用必要的措施识别数据主体是否是未成年人。未成年人的年龄，根据不同国家法律定义存在差异。系统需严格根据交付国家法律判定未成年人。
示例：1）某儿童网站需要儿童注册信息，则须设置额外的机制，保证可以获取并验证该儿童家长的同意。
2）营业厅开户时，需校验开户人的年龄信息，能识别出未成年人，并获取监护人同意，如书面合同的形式获取同意。"
"数据控制者和设备供应者应提供对用户的同意和撤销同意行为进行记录的机制
1、通过系统获取用户同意时，系统应对用户的同意进行记录。
2、用户个人数据在云端收集、处理的场景，用户同意的相关信息必须在云端存储和记录。
3、对于个人数据保存在端侧的产品或者应用应将同意信息记录在端侧。
4、用户撤销同意时，也应对撤销同意行为进行记录。
5、对于设备供应者，如果产品直接面向数据主体，那么产品应提供对数据主体的同意进行记录的机制。具体实现，可以参考1-4条针对控制者的要求。

说明：
隐私协议或用户条款通过系统获取用户同意时，系统应对用户的同意进行记录，记录至少包括给出同意的日期和时间、同意的内容（即与同意相关的隐私策略或者相关的隐私声明版本号）。对于用户个人数据在云端收集、处理的场景，用户同意的相关信息必须在云端存储和记录。对于个人数据保存在端侧的产品或者应用应将同意信息记录在端侧（对于个人数据不上云端，并且个人数据的处理和收集都在端侧完成的情况，不强制要求记录同意行为）。
当用户撤销同意时，也应对撤销同意行为进行记录，记录至少包括撤销同意的日期和时间、撤销同意的内容（即与撤销同意相关的隐私策略或者相关的隐私声明版本号）。
对于设备供应者，如果产品直接面向数据主体，那么产品应提供对数据主体的同意进行记录的机制。"
"对于数据控制者和设备供应者,涉及到直接面向数据主体并提供界面的产品，在对需数据主体的个人数据实施限制处理前，需通知数据主体
1、通过系统获取用户同意时，系统应对用户的同意进行记录。
2、用户个人数据在云端收集、处理的场景，用户同意的相关信息必须在云端存储和记录。
3、对于个人数据保存在端侧的产品或者应用应将同意信息记录在端侧。
4、用户撤销同意时，也应对撤销同意行为进行记录。
5、对于设备供应者，如果产品直接面向数据主体，那么产品应提供对数据主体的同意进行记录的机制。具体实现，可以参考1-4条针对控制者的要求。

目的和意义：
记录用户同意和撤销同意的信息，以供数据控制者能够证明数据主体已对处理其个人数据的行为予以同意或禁止。

说明：
隐私协议或用户条款通过系统获取用户同意时，系统应对用户的同意进行记录，记录至少包括给出同意的日期和时间、同意的内容（即与同意相关的隐私策略或者相关的隐私声明版本号）。对于用户个人数据在云端收集、处理的场景，用户同意的相关信息必须在云端存储和记录。对于个人数据保存在端侧的产品或者应用应将同意信息记录在端侧（对于个人数据不上云端，并且个人数据的处理和收集都在端侧完成的情况，不强制要求记录同意行为）。
当用户撤销同意时，也应对撤销同意行为进行记录，记录至少包括撤销同意的日期和时间、撤销同意的内容（即与撤销同意相关的隐私策略或者相关的隐私声明版本号）。
对于设备供应者，如果产品直接面向数据主体，那么产品应提供对数据主体的同意进行记录的机制。"
"隐私声明有更新时（收集的个人数据的范围、使用目的发生变化），需要告知用户并重新获取数据主体的明示同意。
说明：
1、如果隐私声明发生变化（收集的个人数据的范围、使用目的发生变化），则需要提供重新收集数据主体明示同意的机制。
2、个人数据采集、使用目的变更，应当更新隐私声明，告知用户查看并获得用户同意"
"个人数据收集范围、使用目的不得超出隐私声明，且遵循最小化原则。
1、产品或服务不允许收集隐私声明中没有列出的个人数据，不允许将个人数据用于没有声明的目的。
2、个人数据的采集范围、使用目必须与隐私声明中的描述保持一致，并且遵循最小化原则（仅收集业务必须的数据）。
3、对于非业务必须的个人数据应遵循以下原则：
a.尽量不处理非业务必须的个人数据。
b.如果对非业务必须的个人数据进行处理，需提供开关控制，默认关闭，并且只有在获得用户同意以后再进行处理。
c.方案选择上，尽可能选择不需要处理个人数据，又可满足业务需求的替代方案。
4、对数据主体的个人数据的采集范围、使用目的有变更时，应当更改隐私声明，并在重新得到同意之后才能进一步处理数据主体的个人数据。

说明：
个人数据采集、使用不得超出预先在隐私声明中描述的目的，处理个人数据的范围严格按照隐私声明的描述。若对数据主体的个人数据的采集范围、使用目的有变更，应当更改隐私声明，通过适当的方式获得数据主体/数据控制者/数据处理者对于新的隐私声明的同意，在得到同意之后才能进一步处理数据主体个人数据。
1. 对于数据处理者或设备供应者，如个人数据的收集范围、使用目的发生变更应在产品客户资料中告知个人数据处理的变化。
2. 对于数据控制者，发布新隐私声明时，可以通过弹出提示框、发送电子邮件等方式直接告知数据主体隐私声明的更改之处，或者提供简短声明说明更改之处，并附上旧政策的超链接，数据主体可以点击该链接获得更多详细信息。
3、比如统计用户电话归属城市、居住区域，则可以仅采集电话号码的前几位信息，或者家庭地址的城市区域信息，不需要收集详细的家庭地址。"
"在Web系统中，如果提交的数据中包含个人数据，则禁止使用Get方式提交个人数据
1、在Web系统中，禁止使用Get方式提交包含个人数据的信息。
2、使用RESTful接口的场景，不强制要求遵守此要求，由于RESTful接口约定GET表示“从服务器取出资源”，而POST表示“在服务器新建一个资源”。

说明：
Web代理和网管系统通常会默认缓存以及记录每一个GET提交的URL，对POST请求则不会。并且使用GET是使用查询字符串方式传递表单数据，容易导致个人数据泄露。可以使用POST请求来避免个人数据被缓存、记录。"
"系统应将隐私保护的功能默认设置成保护状态。
1、涉及到保护用户隐私的设置或者配置，须默认对隐私设置成保护状态。对于符合业界惯例的情况，不强制要求满足该条规则。

说明：
产品的默认设置（比如应用对通讯录权限管理）应对隐私进行保护，不需要用户去做一些额外操作才能达到保护隐私的目的。"
"1、敏感个人数据禁止明文存储在系统日志文件、代码、Cookie中（存储类软硬件产品除外，如硬盘，数据库等）。
2、操作人员访问个人数据之前须对其身份及权限进行验证。
3、产品对于个人数据的访问控制策略须满足不同职位职能的权限要求，并可以取消操作人员的访问权限。
4、数据主体的银行卡号在存储前须采用安全加密机制进行加密，禁止存储CVV2。
5、（可选）具有个人数据导出功能的产品，导出时应提醒操作人员导出的数据中包含个人数据。
6、健康数据（如心率、心电图、血糖、血脂、体重、身高等）、运动统计数据（如睡眠、步数等）需要加密保存。

说明：
本地存储和使用个人数据时，应采取充分的安全措施，包括身份认证、权限控制、日志记录、完整性保护等来保护个人数据。口令不允许明文存储在系统中，应该加密保护。在不需要还原口令的场景，必须使用不可逆算法加密。在系统日志文件、告警信息、代码、cookie等中，敏感个人数据不得以任何明文形式出现。
产品应设计系统内部集中存储的个人数据的访问控制策略，支持权限细分，以满足不同职位职能的权限要求（如操作员角色和系统管理员角色）。
对于需遵循PCI-DSS标准的产品，如支付类产品，必须对本地存储的银行卡号进行加密存储，禁止存储CVV2。

涉及个人数据的采集/处理的功能须提供安全保护机制（如认证、权限控制、日志记录等），并通过产品资料向客户公开。"
"涉及个人数据的采集/处理的功能须提供安全保护机制（如认证、权限控制、日志记录等），并通过产品资料向客户公开。
说明：
1、涉及个人数据处理的产品或服务必须提供隐私声明；并且个人数据收集范围、使用目的不得超出隐私声明；个人数据的采集范围、使用目必须与隐私声明中的描述保持一致。
2、向运营商或企业客户提供的隐私声明内容必须完整；产品在设计文档中列出所收集的个人数据列表，标明个人数据的收集目的及保护措施，如：列出产品收集和处理个人数据的场景、个人数据类型、处理方法、收集目的、个人数据的保护措施以及数据存留期等。
3、以华为名义直接向数据主体提供的产品或服务时，提供的隐私声明必须经过法务部批准，并在web产品页面或是界面上提供隐私声明或隐私声明的链接。

3.1 对于基于现网设备中的个人数据进行进一步整理、分析，且有华为人员参与数据处理的增值服务场景，允许采集、处理系统中的个人数据，但必须遵循如下要求：
1）对个人数据采集或处理的相关操作，必须提供安全保护机制（如认证、权限控制、日志记录等），防止个人数据被泄漏。
2）对于所涉及的个人数据，应支持在呈现界面上（如显示界面、文件存储/导出等）进行过滤或匿名化或假名化。
3）相关操作必须得到客户的授权，禁止进行超出客户审批范围的任何操作，在完成服务后，必须在客户的监督下对所涉及的个人数据进行安全删除，针对敏感市场未经客户授权禁止传出客户网络，并在相关GPI资料中增加提示。
4） 必须在产品CPI资料中对产品涉及用户隐私的功能进行描述和声明：
- 描述该功能处理用户个人信息的目的、范围、处理方式、时限。
- 声明：要求客户使用该功能时遵从当地适用的法律法规。
5)  在具体销售合同中，要求客户保证使用（包括要求华为根据其指示使用）涉及隐私部分的功能时符合当地使用的法律法规，并保证华为不因此产品功能的开发设计，遵循其指示或授权进行维保等操作行为而遭受任何损害及风险，包括但不限于直接或间接的个人损害、商业赢利的丧失、贸易中断、商业信息的丢失或任何其它经济损失。"
"基于正常业务流程，在征得用户同意的情况下，采集的通信内容（语音类、短信/彩信类、传真类、数据业务类）需要提供安全保护机制（如认证、加密、权限控制、日志记录采集动作等保护机制）。用户有随时取消通信内容被采集的权利。

说明：
1、系统向自然人下发的业务短信也属于原始通信内容，在加以安全保护（涉及敏感数据的需要对敏感数据加密）的前提下可以通过正常的业务功能进行存储，如通过数据库、配置文件存储；注意这里的“正常”的业务功能是指标准的、业界通行的功能。"
"针对管理面，对个人数据的访问（增删改查、上传下载、导入导出）必须记录操作日志，包括操作员、最终用户人机接口的访问及第三方系统发起的机机接口的访问。对于只提供命令行的管理界面，查看个人数据的行为不强制要求记录日志。
说明：日志记录要求参见“SEC-APP-LOG-01 对安全事件及操作事件记录日志”，其中查询条件需要记录，可以存放到“被访问资源的名称”，“结果”字段只记录成功或失败，不记录具体返回结果。

1、对于高风险如资金交易、支付场景，银行卡号的查询操作需记录日志，且银行卡号禁止明文存储在操作日志中，应进行匿名化处理。"
"正确使用假名化、匿名化或加密机制进行个人数据保护。
1、不需要保留个人数据原始形式的场景下应对个人数据进行假名化或加密保护，防止个人数据泄露。
2、假名化数据仍是个人数据，需要遵从个人数据处理的各项要求。
3、电信开户场景，系统运维界面展示敏感个人数据时，应当考虑匿名化个人数据。

目的和意义：
对个人数据进行正确的保护，防止个人数据泄露。

说明：
系统应该考虑个人数据是否需要保留其原始形式， 应对数据进行假化名或加密保护，防止个人数据泄露。"
"对于存储个人数据的系统，需对存储的个人数据定义存留期。
1、对于数据控制者，必须根据个人数据的使用目的以及法律要求给个人数据定义存留期，并保证数据存留期可配置。
2、对于数据控制者，超过存留期后，必须提供删除或者匿名化过期个人数据的机制。
3、对于数据控制者和处理者，产品运行期间临时产生的包含个人数据的文件，产品运行结束后必须自动删除或匿名化其中的个人数据。
4、WIFI直连应用中，导入联系人时不得将联系人信息明文永久暴露在SD卡存储区。
5、对于数据控制者，系统无法给出个人数据保留时长的定义时，系统需要提供支持存留期策略的机制，例如：系统定义在用户销户时删除相关的个人数据。
6、对于设备供应者，应根据客户需求，或者按照业界惯例，提供数据存留期可支持控制者配置的功能。无法给出个人数据保留时长的定义时，产品需要提供支持存留期策略的机制。
7、对于终端类产品，临时数据以及收集后不再使用的个人数据，应及时删除、销毁或采取匿名化处理。

说明：
必须根据其收集、使用目的来确定存储的个人数据的存留期，存留期等同于完成个人数据使用目的时间。对于法律有特殊要求的数据（如交易类的金融信息）可按照法律要求保存。必须提供删除/匿名化机制或指导来处理超过存留期的个人数据。可以提供机制根据个人数据存留期设置删除周期，由程序自动删除。也可在产品客户资料中描述删除或是匿名化个人数据的方法，指导客户使用。对于备份系统中超过存留期的个人数据，应在客户资料中告知客户进行定期删除。
对于设备供应者，应根据客户需求，或按照业界惯例，提供机制或指导来删除或是匿名化超过存留期的个人数据。"
"对于数据控制者，数据主体撤销同意之后，产品必须禁止继续收集和处理其相应个人数据。
1、对于数据控制者，数据主体撤销同意之后，不允许继续收集数据主体个人数据。
2、对于数据控制者，数据主体撤销同意之后，不允许继续使用已收集的个人数据。如果由于计算周期长等合理原因而无法马上停止处理，须保证在下一周期前停止处理。
3、如果产品提供用户注销帐号的功能，需要在该用户注销以后删除该用户相关个人数据。如果产品提供帐号保留期，允许用户在保留期重新激活帐号，那么在此期间，需要停止对该用户个人数据的处理，超过保留期以后，需要删除用户个人数据。
4、对于设备供应者，由于有些场景无法直接获取数据主体的撤销同意，或者在获知数据主体撤销同意后无法直接删除相应个人数据（可能会影响业务或系统可靠性），因此不强制要求满足该条规则。产品在设计时应根据客户需求，或者按照业界惯例，停止继续处理或者提供删除相应个人数据的机制。

说明：
用户撤销同意只对未来有影响，而不是对已经发生的并符合法律的数据处理有影响。基于这些数据的以前的处理不能够简单的取消。然而，如果没有其他法律要求继续存储这些数据，数据控制者应该删除该数据。
对于设备供应者应根据业务需要，业界惯例，停止继续处理或者提供删除相应个人数据的机制。

"
"对于数据控制者和处理者，如在设备维修、销毁或云资源回收的场景下，必须提供安全删除的机制或指导，设备供应者不强制要求。
1、必须删除其中包含的个人数据。
2、删除个人数据时，不能只是简单删除文件的逻辑标志。
3、在没有提供安全删除机制时，必须提供安全删除的指导

说明：
对于数据控制者和处理者，因设备维修、销毁需要移出网络或云资源回收场景，产品必须提供对其中存储的个人数据进行安全销毁的机制。
设备供应者应根据客户/GTS维护团队的需求或根据风险等级决定是否提供相应的安全删除的机制或指导。"
"1、日志中应避免打印个人数据。产品出于问题定位、业务特性需求的情况下，日志记录相关个人数据应遵循最小化原则。
2、保存有个人数据的日志的安全保护措施不低于系统对日志所包含个人数据的保护措施。
说明：
原则上，日志中应避免打印个人数据。产品出于问题定位、业务特性需求的情况下，日志记录相关个人数据应遵循最小化原则，并且保证对日志的安全保护措施不低于日志所包含个人数据的保护措施。建议对日志的存留期可配置。如果日志记录机制可以阻断或关闭，该行为权限要严格限制，并且要记录日志。
如果有客户需求，建议由业务特性功能本身生成的数据文件记录客户需求必须的个人数据。
对于终端类产品，用于问题定位的日志中应避免打印个人数据。如果必须打印个人数据（如调试目的），必须对个人数据进行匿名化处理，防止应用或个人通过日志获取用户的个人数据。"
"对于提供用户画像（Profiling）的系统应为用户提供退出用户画像（Profiling）分析的机制。
1、提供个人数据分析功能的系统必须为用户提供退出分析的机制。
2、用户退出分析后，系统不再对用户的个人数据进行处理。如果由于计算周期长等合理原因而无法马上停止处理，须保证在下一周期前停止处理。

说明：
系统提供个人数据分析功能时，应为用户提供退出分析的机制。并确保执行数据主体的撤销同意操作以后，不会再对其个人数据进行处理。如果由于计算周期长等合理原因而无法马上停止处理，在下一周期前停止处理。"
"对于收集和处理个人数据的系统应该提供未授权的访问或恶意攻击的检测机制
1、提供对未授权访问或其它恶意攻击的检测方法。
2、对安全事件如登录失败、异常或潜在恶意呼叫等进行记录并进行监控。

说明：
实现对于系统中未授权访问或恶意攻击的检测方法，至少记录所有安全事件（登录失败，异常或潜在恶意呼叫等），并对安全事件进行监控以创建有关此类事件的告警。对于在网络环境中运行的云服务等产品，还应实施网络监控。评估数据泄露等安全事件的影响（包括涉及哪些个人数据、涉及的数据做了哪些防护等），并且及时触发事件处理流程。
示例：通过权限控制仅允许应用程序访问个人数据表，维护人员不访问；开启记录后台维护操作数据库的审计日志，不记录应用程序操作数据库的审计日志。
"
"对于收集和处理个人数据的系统应提供个人数据备份和恢复的机制，能够恢复系统中存储的个人数据
1、提供对系统中的个人数据进行备份和容灾处理的机制及个人数据完整性校验的机制，保证系统中存储的个人数据可恢复。
2、备份系统的权限控制、加密等保护措施应不低于生产系统中的个人数据的保护措施。
3、提供机制保护备份数据的完整性（如文件完整性校验），定期测试备份数据恢复可用性

说明：
对系统中的数据进行备份和容灾处理机制时，应首先保证系统中存储的个人数据可以恢复，同时，应提供个人数据的完整性校验机制。
对于设备供应者，如果个人数据丢失对数据主体访问没有影响（如设备上的呼叫历史记录（CHR）等日志类信息丢失对数据主体访问没有影响）的情况下，产品可以不提供个人数据备份和恢复的机制。"
"对于数据控制者，将数据主体个人数据提供给第三方前，必须获得数据主体的同意
1、数据控制者将数据主体个人数据提供给第三方前，必须告知数据主体转移的个人数据类型、转移目的以及数据接收方的相关信息，并获得其授权。
2、数据控制者必须提供数据主体拒绝将个人数据提供给第三方的功能。
3、数据控制者提供给第三方的个人数据必须是业务所必需的数据。
4、数据控制者提供给第三方的个人数据如果用于新的目的，必须获得用户同意。
5、对于设备供应者，如果客户提供了明确的需求，或者按照业界惯例提供了相应机制，或者产品分析认为不提供该机制隐私风险高，产品须在设计时提供相应的获取数据主体授权的机制。

说明：
华为作为数据控制者，在将数据主体的个人数据提供给第三方前，必须提供合理方式告知数据主体转移的个人数据类型、转移目的以及数据接收方的相关信息，并获得数据主体的同意。只有在数据主体同意之后，才能向第三方提供个人数据。为了履行政府授予数据控制者任务等法律允许的情况例外（如司法调查协助）。
对于设备供应者，需根据业务需要以及风险等级来确定，在将个人数据提供给第三方时是否需要提供机制来获得数据主体的授权。"
"对高影响个人数据在非信任网络间传输时须使用安全传输通道或加密后再传输
1、高影响个人数据（定义参见“术语定义”中个人数据的定义）在非信任网络间传输时须使用安全传输通道或加密后再传输。
2、在非信任网络之间传输批量个人数据时须采用安全传输通道或者加密后传输
3、（可选）对中、低影响个人数据在非信任网络间传输时，建议使用安全传输通道或加密后再传输。

说明：
对高影响个人数据在非信任网络间传输时须使用安全传输通道或加密后再传输，按照标准协议传输的报文头中包含IP、MAC地址等数据时，不在该规则要求内。对中、低影响个人数据在非信任网络间传输时，建议使用安全传输通道或加密后再传输。在非信任网络之间传输批量个人数据时须采用安全传输通道或者加密后传输，有标准协议规定除外。加密算法和密钥管理要符合公司的《密钥管理安全规范》和《密码算法应用规范》。


"
"数据控制者必须对数据主体录入的个人数据提供查询、更新的机制以及删除所有数据主体的个人数据的机制，对于从第三方获取个人数据时，系统需提供个人数据更新机制
1、数据控制者应向数据主体提供查询、更新、删除个人数据的功能，该功能必须是实时并且无成本的。
2、数据主体发出查询、更新、删除个人数据的请求时，数据控制者必须验证数据主体的身份。
3、数据控制者应告知数据主体查询、更新、删除个人数据的方式。
4、针对用户的注册信息，必须为用户提供修改其注册信息的途径。特殊业务场景，如因业务需要不可修改，则在用户录入时必须告知用户。
5、数据主体提出更正、清除个人数据或限制处理个人数据，控制者可以通过系统间消息等方式将这些信息通知到个人数据公开后的第三方。
6、如果应用系统所收集的个人数据完全是从第三方系统获得的情况，系统需要提供接收第三方系统个人数据更新的机制，以确保数据主体的个人数据保持最新状态。
7、对于设备供应者，如果客户提供了明确的需求，或者按照业界惯例提供了相应功能，产品须提供相应的查询和更新数据主体提供的个人数据的机制。产品需评估提供向第三方披露个人数据的接口风险。如需提供，则应配套实现主动向第三方更新、清除或限制处理个人数据的能力。

说明：
对于数据主体录入的个人数据，数据主体有权访问、更新、删除他们的个人数据，包括可以更改联系方式和隐私偏好等。用户修改隐私偏好的设置和选项要便于用户发现和使用。数据主体提出更正、清除个人数据或限制处理个人数据，控制者可以通过系统间消息等方式将这些信息通知到个人数据公开后的第三方。
如果应用系统所收集的个人数据完全是从第三方系统获得的情况，系统需要提供接收第三方系统个人数据更新的机制，以确保数据主体的个人数据保持最新状态。
数据主体可以访问的个人数据包括：数据主体提供的个人数据及根据个人数据生成的结果。针对数据主体的个人数据的分析结果需要展示，为业务需要进行群体类分析的结果不需要向数据主体展示。
若产品直接提供了数据主体输入个人数据（包括他人个人数据）的接口，则产品必须向数据主体提供合适的查询、更新个人数据的功能（如提供修改界面，不包括绕开产品、手动直接查询数据库的方式），并且做到：
 1）该功能必须对数据主体来说没有任何成本，而且是实时的；
 2）数据主体访问个人数据之前必须有认证机制。
对于设备供应者，应根据业务需求、业界惯例提供相应的查询和更新个人数据的机制。
"
"面向最终用户的系统，需在用户自助注册个人信息时，提供验证用户身份凭据的机制
1、数据主体注册时系统应通过email中的激活链接、短信的验证码等方式验证数据主体的身份。

说明：
数据主体注册时系统应验证数据主体的身份，如：通过email中的激活链接、短信的验证码进行身份验证。"
"对于收集、处理、存储个人数据的系统，应提供数据主体限制其个人数据处理机制
1、数据保留在系统时，对被限制处理的个人数据需要明确标识且不会被继续处理
2、系统必须实现标记数据失效的方法。可以通过暂时移动数据（存储数据到一个暂时的系统并从主要系统中迁移出去）或者在系统中标记数据为可用/不可用。如果数据被保留在系统中，必须有一个健壮的机制来保证冻结数据不会被用于处理。
例如：
1）数据库中有属性标明某些属性被冻结，查询时会隐藏任何已经被冻结的属性。（操作员可以查看，如果没有对用户造成伤害可以查看是可以的，但是如果对用户造成伤害，例如在黄页中就要隐藏不正确的数据）
2）如果用户意识到某公司存储的用户的个人数据是错误的，这种情况下就需要对个人数据的处理进行限制。比如黄页服务中有错误信息，用户要求刷新更改其数据，在确定正确数据的这段时间内，就需要限制个人数据的处理。例如华为商城，购买历史和购买订单不希望删除，有错误时可以限制处理，例如付款时提供的地址错误，可以冻结支付过程，待提供正确地址后再进行操作。
说明：
如果数据被保留在系统中，必须有一个健壮的机制来保证限制处理的数据不会被继续处理，即，个人数据被限制处理需要被明确的标识。"
"对于收集、处理、存储个人数据的系统，应提供数据主体提供的个人数据导出的机制
1、对于数据控制者，用户的个人数据应该能通过导出、下载等方式提取出来，提取的途径用户或管理员能容易访问。可提取的个人数据的范围见检查项总体要求。
提取出的个人数据的格式必须是机器可读的格式，如XML、CSV等。
客户对系统维护人员的个人数据没有导出需求时，可不提供系统维护人员的个人数据的导出功能。
2、提取出的个人数据的格式必须是机器可读的格式，如XML、CSV等。
3、客户对系统维护人员的个人数据没有导出需求时，可不提供系统维护人员的个人数据的导出功能。
4、对于设备供应者，个人数据导出机制非强制要求，数据控制者明确提出要求时，按照其要求提供此功能。
5、对数据主体产生较大影响的个人数据，如手机中的指纹、系统密钥、生物特征等不需要提供导出功能。

说明：
对于数据控制者，用户的个人数据应该能提取出来（例如：导出或者下载），提取的格式必须是一种机器可读的格式（比如XML，CSV），此特性应该让用户或管理员能够容易访问（比如通过界面，通过API接口等）。如果客户没有导出系统维护人员个人数据的需求，系统维护人员的个人数据可以不提供可携带的权利。
数据主体直接向数据控制者提供的个人数据需要可导出，其中包括数据主体有意识且主动提供的个人数据，如邮箱地址、用户名、年龄等，及数据主体使用服务或者设备“提供”的可观察到的数据，如浏览记录、流量清单、位置数据。"
"对于操作员、第三方接口，须限制其对个人数据的单次访问记录数和访问频率，单次访问记录数和访问频率可配置。
说明：此项要求主要是为了防止个人数据的大量泄漏，可通过应用程序、风险控制系统、日志审计系统对潜在的个人数据大量泄漏行为进行及时预防和告警。
设定访问最大值，通过对超过最大访问频率的访问个人数据进行日志记录、风险告警、黑名单等。如果产品提供批量查询、批量导出、批量变更个人数据的功能，可以通过二次认证、短信授权验证码对这种重大操作进行权限控制。"
对于移动终端，须向最终用户提供《隐私政策声明》。
对于移动终端，通过网络对个人数据进行采集/共享/同步的功能须得到最终用户的明确同意，同时给予最终用户随时撤回同意的机会。
提供应急响应机制，当数据泄露时，自运营的产品需要给高风险的用户发送风险通知；非自运营的产品需识别数据泄露的场景并通过PSRIT流程支持预警到客户。

"禁止使用私有密码算法或使用未经过专业机构评估的算法。
1、禁止使用自行设计的密码算法或使用未公开算法细节未经过专业机构评估的算法；
注：专业机构为业界知名权威安全机构，例如：
•德国信息安全机构——联邦信息安全办公室（BSI）
•欧盟网络和信息安全局（ENISA）
•欧洲密码技术卓越网络（ENCTYPR II）
•国家标准技术局（NIST）
2、禁止自行对标准密码算法进行改造并使用；
3、禁止使用自行定义的通过变形/字符移位/替换等方式执行的数据转换；
4、禁止使用编码的方式（如Base64编码）实现数据加密目的；
5、禁止使用差错控制编码（如奇偶校验、CRC）实现完整性校验；
6、优先选择国际标准密码算法，中国国密算法在发往国外的产品中应限制使用。
注：出于法律风险和客户认可的考虑，中国国密算法在发往国外的产品中应限制使用
例如：
1）SSF33/SM1/SM7等未公开的国密算法在发往国外的产品中禁止使用。
2）ZUC/SM2/SM3/SM4/SM9等已公开的国密算法在发往国外的产品中可以支持，但须默认关闭，除非客户明确要求或者明确声明不做要求。

说明：
禁止使用私有密码算法实现加解密，包括：
1. 未经过专业机构评估的、自行设计的密码算法；
2. 自行定义的通过变形/字符移位/替换等方式执行的数据转换算法；
3. 用编码的方式（如Base64编码）实现数据加密的目的的伪加密实现。
说明：在非加解密场景（不需要加密且产品未在界面、资料声称进行了加解密），出于正常业务目的使用Base64等编码方式或变形/移位/替换等算法不违反此条。"
"禁止使用公司认定的不安全的加密算法，出于行业标准遵从、与第三方对接、向下兼容、必须满足的客户定制特性等场景例外。
1、禁止使用blowfish、RC4、DES、2TDEA等弱加密算法加密数据
2、禁止MD5用于以下密码学安全用途：数字签名、认证凭据保存、完整性保护、HMAC、密钥导出以及随机数产生
3、禁止使用密钥长度小于2048比特的DSA及DH算法，禁止使用密钥长度小于等于223的ECDH算法
4、禁止使用SHA-1作为数字签名的Hash算法，禁止SHA-1用于hash-only场景。
5、RSA算法密钥长度至少为2048比特（2048比特可用至2030年），推荐3072比特。

说明：1、禁止使用业界已知不安全的加密算法,DES/3DES（除密钥K1≠K2≠K3外的场景）/SKIPJACK/RC2/RSA（1024位及以下）/MD2/MD4。
说明：
1）禁止MD5应用在参与生成“数字签名、口令加密保存”这两种场景（HMAC-MD5例外），禁止SHA1应用在参与生成“数字签名”的场景；
2）SHA1算法可用于HMAC、PBKDF2、随机数发生器的场景；
3）标准协议定义且没有替代算法的、或需要与第三方系统对接、或兼容老系统的除外。如需要与第三方系统对接或兼容老系统，产品支持使用不安全密码算法的情况，对于面向运营商和企业客户的产品，应在产品CPI资料或界面中提示风险。对于运营商定制的使用不安全算法的场景，终端类产品可以例外。
2、推荐使用的密码算法：
1）分组密码算法：AES（密钥长度在128位及以上）
2）流密码算法：AES（密钥长度在128位及以上）（OFB或CTR模式）
3）非对称加密算法：RSA（密钥长度在2048位及以上，推荐3072位)
4）哈希算法：SHA2（256位及以上）
5）密钥交换算法：DH（2048位及以上，推荐3072位)
6）HMAC（基于哈希的消息验证码）算法：HMAC-SHA2
3、缺省使用安全的加密算法，如客户选择不安全的加密算法，应提示安全风险。"
"1.计算口令单向哈希的盐值应由安全随机数生成，每次口令重新哈希保存时，应使用新的盐值。如修改口令，保存新口令时，应使用新的随机盐值。
2.对称加密（例如AES-CBC模式）时禁止使用固定IV（如：写死在代码里，或固定在配置文件中）
1）、向下兼容场景，被兼容版本在客观上确实无法整改（如客户明确要求不允许升级或确实没有升级的时间窗口），则该条不做要求
2）、如可保证每次加密时密钥各不相同，则IV可以固定
3）、密文检索场景可例外
3、禁止使用前一次加密的最后一个密文分组数据作为下一次加密的IV（这是TLS 1.0受到的BEAST攻击的根因）。

说明：对于基于密钥组件的根密钥管理方案，用于导出根密钥的IV或者盐值可例外，详见《密钥管理安全规范》中基于密钥组件的根密钥管理详细方案描述。"
"1、禁止使用SSL2.0和SSL3.0协议
2、TLS1.0仅在向下兼容、第三方对接等场景下可遗留使用
3、禁止使用SSH V1.x, 禁止CBC模式用于SSH2.0协议中
4、密码协议中禁止使用匿名认证（即不做身份认证）或弱身份认证（如密钥长度小于2048比特的RSA/DSA密钥）。在对接华为以外的第三方的场景下，客户端允许以开关的方式控制是否判断服务端的身份。
5、密码协议中禁止使用无对称加密的套件（不做消息加密）
6、禁止在SSL/TLS里使用包含RC4的算法套件，且密码协议中禁止使用弱对称加密算法（如DES算法）。
7、密码协议中禁止使用弱消息认证算法（如HMAC-MD5）。
8、禁止选择使用RSA作为密钥交换算法的加密套件，至少将此类套件作为低优先级加密套件，推荐仅选择使用DH或ECDH作为密钥交换算法的加密套件。
9、密码协议中禁止使用弱密钥交换算法（如密钥长度小于2048比特的RSA/DH密钥交换）。
10、在需要使用流加密的场景下须使用AES的OFB和CTR模式或chacha20流加密算法替换（标准协议规定的除外，如：3GPP的A5算法除外）
11、(可选)SSH协议建议优先选择ECC密钥交换算法和身份认证公钥算法，优先选择HMAC-SHA2消息认证算法

建议优先使用业界的标准安全协议（如SSH v2/TLS1.1/TLS1.2/IPSec/SFTP等）"
"对口令进行单向哈希时，必须使用基于口令的密钥导出派生算法。
1、使用PBKDF2算法计算口令单向哈希时，迭代次数最低10000次（有特殊性能要求时最低1000次）、盐值至少为8字节安全随机数、哈希算法推荐使用SHA256及以上、输出长度不少于256比特。
2、使用scrypt算法计算口令单向哈希时，内存占用参数至少为2^14、盐值至少8字节、块规模参数至少为8、并行化参数至少1，输出长度不少于256比特。"
"1、手动输入的值，不可直接作为密钥使用。
说明：不允许将用户从键盘输入的值直接或间接作为加密密钥使用（如：使用用户从键盘输入的值和固定的字符串作为密钥使用）。

2、手动输入的值，如口令，作为密钥时，须先采用密钥导出算法（如 PKCS5）对它进行处理，之后得到的结果才能作为加密算法的工作密钥。
说明：
1）导出的密钥比口令具有更好的密码学特性，安全性更高；
2）公司开发的加密库，其中包含了密钥导出函数：PKCS5-deriveKey(…)，可以直接调用该函数导出加密的密钥。Java 中请参考类 PBEKeySpec；
3）请参考“说明”页签中名词解释对“根密钥”、“工作密钥”的解释。"
"密钥的用途需单一化，即一个密钥应只用于一种用途。
说明：
1、同一笔业务中，若既需要加密运算也需要计算MAC，则加密操作和计算MAC操作不允许使用同一个对称密钥。
2、同一笔业务中，若既需要使用非对称加密又需要进行数字签名，则加密使用的公钥和签名使用的私钥不允许来自同一个密钥对或同一个数字证书。"
"用于敏感数据传输加密的密钥，不能硬编码在代码中。
说明：
用于敏感数据传输加密的密钥，不能硬编码在代码中，系统应提供密钥管理（含密钥修改）或密钥协商更新的机制。对于面向运营商和企业客户的产品，产品CPI资料中应提醒用户修改及定期更新，并提示风险。"
"1、用于敏感数据本地存储加密的密钥，不能直接硬编码在代码中，系统设计和功能里必须设计和支持工作密钥更新方法（密钥更新方式：手动更新、自动更新等），并规定工作密钥更新规则（在线更新、离线更新、更新时间等）。
2、禁止硬编码根密钥于代码中，如需对根密钥进行硬编码，则仅可对其部分密钥组件（Key Component）进行硬编码。并且采用密钥组件方式生成根密钥时，密钥组件需要分散存储，当密钥组件存储于文件中时，须对文件名做一般化处理。

说明：
1）对密钥的管理要求有安全保护措施（如认证、权限控制、日志记录）。
2）根密钥硬编码在代码里虽然没有被严格禁止，但仍然建议使用成熟的根密钥保护方案替代根密钥硬编码；根密钥是否需要更新应根据使用场景决定，暂不要求必须支持可更新"
"密钥不允许明文存储在系统中，应该加密保护并提供访问控制。
1.密钥不允许明文保存在本地；密钥材料及密钥组件在本地保存时须严格控制其权限（如权限600或400）。"
"应对需要备份的密钥设计和实现密钥备份的功能，并制定密钥备份的规定。
密码安全是基于密钥安全的， 密钥的损坏或丢失将造成密文信息无法解密，无法解密的密文信息即可认为数据被不可逆转的损坏，高价值或关键数据的损坏是应用系统无法接受的，所以必须为加密高价值和关键数据的密钥提供密钥的备份和恢复机制。
说明：
本项为规范建议，产品可根据实际业务场景或客户需求分析是否符合要求。"
"不再使用的密钥应当立即删除。
1、对于内存中的密钥，释放前应对保存密钥的内存空间填充其他值（如：全0）。
2、对于本地存储（本地文件、数据库等）的密钥（通常以密文形式存在），应被完全删除（包括密钥的全部副本）并对相应的磁盘空间重复写入其他数据（推荐写“0”或“1”覆盖三次或以上）。"
"1、密钥的生成、使用（密钥作为管理用途，如：加解密密钥、派生密钥必须记录日志；作为业务用途，如：加解密业务数据则不强制要求）、更新、销毁等操作的操作需记录日志。
2、日志中需详细记录密钥的各项管理操作，包括但不限于记录操作的主体（人或设备）、时间、目的、结果等可用于事件追溯的信息。"
"禁止随版本提供解密工具和绕过系统认证鉴权的修改口令工具。
说明：这类工具非常危险，容易被质疑为“后门”。

1.6 禁止在产品对外部用户发布的软件（包含软件包/补丁包）中提供具有“口令破解能力”（指口令暴力破解、利用系统/算法漏洞恶意破解口令等）的功能或者工具。"


"删除所有不必要的功能，例如脚本、驱动程序、属性、子系统、文件系统和不必要的 Web 服务器。
说明：确认所有不必要的功能（例如脚本、驱动程序、属性、子系统、文件系统等）都已删除。"
"防止业务资源（如用户注册、发送短信、彩信、邮件、打免费电话、好友推荐等资源）被滥用。
说明：业务资源一旦被滥用，将导致垃圾短信/彩信、垃圾邮件等。"
系统的管理平面和近端维护终端、网管维护终端间，支持使用合适的安全协议（如SSH v2/TLS1.1/TLS1.2/IPSec/SFTP/ SNMPv3等）；对于公司指定的已知不安全的FTP、Telnet和SSHv1协议应支持关闭。
"系统支持无法从用户面直接登录连接管理接口（不支持独立的管理IP地址的产品除外）。
"
"针对系统的重要数据需要提供完整性保护机制。

说明：
1、如对系统的paf.txt和License.txt文件需要提供完整性校验机制。
2、为了防止内鬼非法牟利，对系统敏感数据（如金额类数据）进行完整性保护。
3、使用HMAC进行完整性保护，禁止使用SHA（key||message）方法。"
"禁止将隐藏文件设置成启动文件，确保隐藏文件可以被查询。

说明：隐藏文件不可查询，同时没有资料描述情况下容易被质疑成后门。"
"在服务器端对业务流程机制进行必要的流程安全控制，保证流程和功能正常运行，防止关键鉴别步骤被绕过、重复、乱序。
说明：
客户端流程控制很容易被旁路（绕过），因此流程控制必须在服务器端实现。
在系统中会导致系统或系统部分功能更新、延时、停滞、反复判断的触发机制，包含但不限于：
1）触发密钥过期、更新、等待、停用等
2）触发使某功能升级、维护、过期、锁定、异常、告警、备份、暂停
3）触发使某规则或逻辑进行反复判定
4）触发使低级告警急速增大
5）触发优先级判定逻辑
6）触发排队算法的逻辑
7）触发逻辑进行异常处理"
应该配置应用防火墙以抵御通用攻击。

"系统所有的对外通信连接必须是系统运行和维护必需的，对使用到的通信端口在产品通信矩阵文档中说明，动态侦听端口必须限定确定的合理的范围。通过端口扫描工具验证，未在通信矩阵中列出的端口必须关闭。
"
所有能对系统进行管理的人机接口以及跨信任网络的机机接口必须有接入认证机制。
"所有能访问需要保护的数据的接口必须有接入认证机制。
说明：
参考“敏感数据”章节。"
"未在通信矩阵中列出的端口所属的服务软件应卸载。
说明：“关闭非必需端口”项的提升"
"与终端用户有交互、与非信任网络互联、容易受攻击的协议要进行协议畸形报文攻击测试。

"
系统所有的对外通信连接都必须加密。
若应用接口可从低安全等级的域进行访问，那么访问必须使用安全通道
若系统需同时提供接口给内部操作员使用和最终客户使用，那么这两种接口必须完全独立。
API必须实现对错误的合适处理，内部信息（如文件名、内部IP地址）不能被调用API的对象获取
对于应用，不允许使用随机或动态端口/端口范围
对外只提供必需的最小功能集范围内的API

"管理面所有对系统产生影响的用户活动、操作指令必须记录日志，日志内容要能支撑事后的审计，记录包括用户ID、时间、事件类型、被访问资源的名称、访问发起端地址或标识、访问结果等；日志要有访问控制,只有管理员才能有删除权限。
用户活动包括：
1、登录和注销；
2、增加、删除用户和用户属性（帐号、口令等）的变更；
3、用户的锁定和解锁，禁用和恢复；
4、角色权限变更；
5、系统相关安全配置（如安全日志内容配置）的变更；
6、重要资源的变更，如某个重要文件的删除、修改等。
操作指令包括：
1、对系统配置参数的修改；
2、对系统进行启动、关闭、重启、暂停、恢复、倒换；
3、对业务的加载、卸载；
4、软件的升级操作，包括远程升级和本地升级；
5、对重要业务数据（特别是与财务相关的数据，包括：卡密，蜂蜜，订单，库存，支付账单）的创建、删除、修改；
6、所有帐户的命令行非查询操作命令。"
"需要记录如下日志以供审计。
1、所有个人访问系统组件的操作日志,但日志中不包含卡数据；
2、记录具有根权限或管理权限的任何个人实施的操作日志；
3、记录所有日志审计相关的访问操作；
4、记录无效的逻辑访问尝试；
5、记录系统级对象（参见说明）的创建和删除。"
"提供日志访问控制、日志备份与转储功能。
说明：日志转储是指将日志进行转存，并且将被转储的日志从原系统中删除。"
"有机制能够保证日志文件传输过程中的机密性和完整性。
说明：比如采用安全协议：SSL或SFTP进行日志文件传输。"
提供审计日志查询界面，可以根据UserID、时间、客户端IP、服务器IP多条件查询日志。
日志存留的时间可配置
具备使用syslog向集中日志服务器发送日志的能力。
日志中时间需自适应当地的夏令时
仅管理员能更改日志的产生机制，如是否记录日志的开关
"错误和日志
• 应用须对如下事件记录审计日志:
o 应用管理员的操作
o 应用安全相关的事件
o 认证失败
o 用户的系统访问事件，包括授权和未授权的访问
o 系统级的操作和管理事件
o 系统配置参数变更
o 系统故障
o 访问权限变更
o 启停或改变审计日志产生机制
o SSL链接错误
• 应用产生的错误信息不允许包含任何可能帮到攻击者的敏感数据
• 所有涉及到错误和日志的控制逻辑应在服务端实现
• 缺省应拒绝对管理功能和日志的访问
• 错误处理和日志存储相关的代码须不受恶意代码影响
• 应用须确保审计日志的完整性，确保审计日志产生、删除机制不被非授权终止
• 审计记录及其产生机制的控制功能只对已得到授权的人群开放；任何场景下，用户和管理员都不能直接操控审计日志及其产生机制
• 审计数据须被集成到安全部门的监控系统中
• 事件记录须至少包含：
o 事件发生日期和时间
o 事件严重程度
o 事件源，即导致事件发生的人、程序或部件的标识(登录用户、进程号、ip地址、终端等)
o 事件或原因(发生了访问、错误等)描述
o 如果事件与访问相关，则须记录被访问的资源信息(应用、网络、磁盘等)，访问类型(读、写、view、list、删除等)，访问行为的授权与否，是否使用特权，发起访问的终端或系统
• 若事件相关的访问操作是已授权的，有必要保留被访问数据的标识信息"

对涉及资产、费用的交易（如：定价及相关信息的发布同步，以及订购，支付，退款，发货，卡密，蜂蜜）需提供数据一致性稽核（用户数据、账户、订购关系、商品同步一致性比对；出账确保所有账户订单、交易流水都出账）和出错处理的功能，如果涉及第三方，需要提供对账机制。对受管控的交易过程（销售相关的发布定价，调账，退款）需提供审批功能，申请和审批职责分离。


"在服务器端对所有来自不可信数据源的数据进行校验，拒绝任何没有通过校验的数据。若输出到客户端的数据来自不可信的数据源，则须对该数据进行相应的编码或转义。

说明：来自客户端的数据包括text、password、textareas、file表单域、hidden fields、selection boxes、check boxes、radio buttons、cookies、HTTP headers、localStorage、sessionStorage、Web SQL database、Indexed database、热点链接包含的URL参数的数据等。
1、使用Appscan工具扫描，扫描结果应进行分析处理，与XSS、SQL注入和命令注入漏洞相关的告警（告警描述中有相应描述），如果确认是问题的，都必须在版本发布前得到解决。
"
"校验输入数据的类型或格式、数据长度、数据范围。

说明：
1、这里的类型包括基本的数据类型（整型、浮点型、字符型等），同时也包括复杂的构造数据类型，例如，email地址、ip地址、日期或者是自定义的数据格式等。
2、必须校验输入数据的长度是否符合要求，长度校验会加大攻击者实施攻击的难度。
3、这里的范围可以是数值范围或者是集合范围。如果输入数据是数值，必须校验数值的范围是否正确，如年龄应该为0～150之间的正整数；如果输入数据是在某个特定集合范围内，必须校验实际输入是否在集合内，如性别应该是男、女。"
"对用户的最终认证处理过程必须放到服务器进行。

说明：
不能依赖于客户端校验，必须使用服务端代码对输入数据进行最终校验。客户端的输入限制或者校验可能会被攻击者绕过。例如，攻击者可以通过禁用浏览器的JavaScript来使客户端代码失效，或者直接采用代理软件拦截并修改输入参数名称和值。客户端的校验只能作为辅助手段，可以减少客户端和服务端的信息交互次数，提高响应速度。"
"禁止将HTTP标题头中的未加密信息作为安全决策依据。

说明：HTTP 标题头是在 HTTP 请求和 HTTP 响应的开始阶段发送的。Web 应用程序必须确保不以 HTTP 标题头中的未加密信息作为安全决策依据，因为攻击者要操作这一标题头是很容易的。例如，标题头中的 referer 字段包含来自请求源端的 Web 页面的 URL。不要根据 referer 字段的值做出任何安全决策（如检查请求是否来源于 Web 应用程序生成的页面），因为该字段是很容易被伪造的。"
"禁止采用未经校验的输入参数直接串联来构造可执行 SQL 语句。

说明：
例如，string sql = &quotselect status from Users where UserName=`"" + txtUserName.Text + ""`""这样很容易被SQL注入攻击。对于java/JSP语言，使用预编译语句PreparedStatement代替直接的语句执行Statement。使用预编译语句PreparedStatement，类型化 SQL 参数将检查输入的类型，确保输入值在数据库中当作字符串、数字、日期或boolean等值而不是可执行代码进行处理，从而防止SQL注入攻击。而且，由于 PreparedStatement 对象已预编译过，所以其执行速度要快于 Statement 对象。因此，多次执行的 SQL 语句经常创建为 PreparedStatement 对象，还可以提高效率"
"禁止未经严格输入校验、直接使用客户端提交的参数动态构建xpath语句。

说明：和动态构建SQL一样，采用未经校验的输入参数来动态构建XPath语句也会导致注入漏洞（XPath注入）。"
"如果服务端代码执行操作系统命令，必须对客户端输入的用于构造命令的参数进行严格的输入校验。

说明：如果服务端代码中使用Runtime.getRuntime().exec(cmd)或ProcessBuilder等执行操作系统命令，那么禁止从客户端获取命令；而且最好不要从客户端获取命令的参数，如果必须从客户获取命令的参数，那么必须采用正则表达式对命令参数进行严格的校验，以防止命令注入（因为，一旦从客户端获取命令或参数，通过;&|<>符号，非常容易构造命令注入，危害系统）。"
"对于产品自身开发实现Web容器的情况下，避免由于编码不当引入缓冲区溢出漏洞。

说明：对于嵌入式系统（如ADSL Modem、硬件防火墙）中的Web应用，由于其特殊性（CPU、内存、磁盘容量有限），没有成熟的Web容器，需要产品自己开发相应的Web容器。在开发过程中要避免由于内存管理不当带来的缓冲区溢出问题。缓冲区溢出缺陷可以导致拒绝服务攻击或者任意代码执行。拒绝服务攻击可以引起进程崩溃；任意代码执行可以更改程序的执行地址，从而运行攻击者的注入代码。"
"1、在注释信息中禁止包含物理路径、数据库连接、SQL 语句信息。
2、对于静态页面，在注释信息中禁止包含源代码信息。
3、对于动态页面不使用普通注释，只使用隐藏注释。
说明：动态页面包括 ASP、PHP、JSP、CGI 等由动态语言生成的页面。通过浏览器查看源码的功能，能够查看动态页面中的普通注释信息，但看不到隐藏注释（隐藏注释不会发送给客户端）。因此，为了减少信息泄漏，建议只使用隐藏注释。"
"应用程序出现异常时，禁止向客户端暴露不必要的信息，只能向客户端返回一般性的错误提示消息。
说明：应用程序出现异常时，禁止将数据库版本、数据库结构、操作系统版本、堆栈跟踪、文件名和路径信息、SQL 查询字符串等对攻击者有用的信息返回给客户端。建议重定向到一个统一、默认的错误提示页面，进行信息过滤。并在日志中记录详细的错误信息，以供入侵检测及问题定位。"
"通过Web上传文件时，必须在服务器端采用白名单方式对上传到Web内容目录下的文件类型进行严格的限制。
说明：
针对上传文件类型的检查，不能仅仅只通过文件的扩展名进行判断，而是需要通过检查文件的文件头来判断。限制Web 容器可以解析执行的文件类型（如：JSP、ASP、ASPX、PHP等）的上传。防止攻击者上传JSP、PHP等获取WebShell控制服务器。
产品的Web应用如果提供上传文件到Web内容目录的功能，必须在服务端对上传的文件类型进行限制（基于白名单机制对文件扩展名进行限制），仅允许上传业务允许的文件类型。
说明：Web内容目录是指通过Web可以直接浏览、访问的目录。"
"在服务器端对上传的文件大小进行限制。

说明：根据产品的具体情况，对上传文件的大小进行限制，避免文件过大占用系统存储空间。
如果上传的文件是压缩包，那么，程序在从压缩包中解压出文件前，必须先读取并判断文件压缩前的大小是否小于限定的文件大小。"
"禁止以客户端提交的数据作为读/写/上传/下载文件的路径或文件名。

说明：建议对写/上传文件的路径或文件名采用随机方式生成，或将写/上传文件放置在有适当访问许可的专门目录（Web内容目录之外），这些文件不应该具有可执行权限，且他们不应该能够覆盖其他可执行文件。
对读/下载文件采用映射表（例如，用户提交的读文件参数为1，则读取第1个文件file1，参数为2，则读取第2个文件file2）。防止恶意用户构造路径和文件名，实施目录跨越和不安全直接对象引用攻击。

如果上传的文件是压缩包，那么，程序在从压缩包中提取出的标准文件名、去除路径，以防止攻击者构造压缩包使解压文件被释放到目标目录之外的目录。
"
"禁止将不属于Web内容目录的文件放置在Web内容目录下。禁止将敏感的静态资源文件存放在Web内容目录下。对于临时文件，必须及时删除。

说明：将本不属于Web内容目录下的文件放置在Web内容目录下、或是将敏感的静态资源文件存放在Web内容目录下，容易被攻击者直接下载获取。Web内容目录指的是：通过Web可以直接浏览、访问的目录。静态资源文件指的是：如报表文件、日志文件、配置文件、数据库文件，或其他临时文件。应该放到Web浏览不到的目录（如：WEB-INF）。"
"禁止将文件绝对路径发送到客户端。

说明：文件绝对路径发送到客户端会暴露服务端的目录结构信息，有助于攻击者了解系统，为攻击者攻击提供帮助。"
"禁止存储并执行非可信来源的文件和代码。

说明：一般来说，来自系统之外的文件和代码都是不可信任的，存储和执行非可信来源的文件或代码会带来重大安全隐患，必须禁止执行上传的非可信数据中的应用代码，任何上传的非可信来源的文件和代码都应放置在Web内容目录之外以防止这些文件被执行。这里所说的执行是指动态页面（如asp、jsp、php）的执行。"
"版本归档时，必须删除开发过程（包括现场定制）中的临时文件、备份文件、无用目录等。
说明：恶意用户可以通过URL请求诸如.bak之类的文件，Web服务器会将这些文件以文本方式呈现给恶意用户，造成代码的泄漏，严重威胁Web应用的安全。"
"归档的页面程序文件的扩展名必须使用小写字母。
说明：很多Web server对大小写是敏感的，但对后缀的大小写映像并没有做正确的处理。攻击者只要在URL中将JSP文件后缀从小写变成大写，Web服务器就不能正确处理这个文件后缀，而将其当作纯文本显示。攻击者可以通过查看源码获得这些程序的源代码。因此，归档的页面程序文件的扩展名必须使用小写字母，如jsp、html、htm、asp等页面程序文件的扩展名分别为jsp、html、htm、asp。"
"归档的程序文件中禁止保留调试用的代码。系统安装、初始化配置过程中使用到的临时帐号，在系统安装、初始化配置完成后，自动删除或者提供手工删除的指导书。
说明：
1、这里的“调试用的代码”是指开发过程中进行临时调试所用的、在Web应用运行过程中不需要使用到的Web页面代码或servlet代码。例如：在代码开发过程中为了测试一个添加帐号的功能，开发人员临时编写了一个JSP页面进行测试，那么在归档时，该JSP页面必须删除，以免被攻击者利用。
2、用于调试和测试目的的帐号在发布前必须自动删除
3、系统安装、初始化配置过程中使用到的临时帐号必须自动删除或者提供手工删除的指导书"
"产品的C/C++和Java的编码实现应遵循公司安全编程规范中的（其它安全编程要求请参考公司《Java语言安全编程规范》）。
1）Java安全编程要求：
禁止直接使用外部输入来拼接SQL语句以防止SQL注入
禁止直接将外部输入传递给Runtime.exe()方法
禁止部署可被远程监控的JVM运行环境
使用强随机数
说明：禁止使用未显式指明目标缓冲区大小的字符串操作函数。
C标准的系列字符串处理函数，不检查目标缓冲区的大小，容易引入缓冲区溢出的安全漏洞。
字符串拷贝函数：strcpy, wcscpy,_tcscpy,mbscpy
字符串拼接函数：strcat, wcscat
字符串格式化输出函数：sprintf, swprintf, vsprintf, vswprintf, fprintf
字符串格式化输入函数：scanf, wscanf, sscanf, swscanf, fscanf, vfscanf, vscanf, vsscanf；stdin流输入函数：gets "
"在 B/S 应用中，对于涉及服务器端数据改动（如：增加、修改、删除）的操作必须进行跨站请求伪造的防范。
说明：
跨站请求伪造是一种挟制终端用户在当前已登录的Web应用程序上执行非本意的操作的攻击方法。例如，如果用户登录网络银行去查看其存款余额，他没有退出网络银行系统就去了自己喜欢的论坛去灌水，如果攻击者在论坛中精心构造了一个恶意的链接并诱使该用户点击了该链接，那么该用户在网络银行帐号中的资金就有可能被转移到攻击者指定的帐号中。
重要的操作如：用户管理、信息维护、业务办理等。"
"在服务器端对所有来自不可信数据源的数据进行校验，以防止MML注入。

说明：
MML通常以“;”进行结束一条语句的执行，需要对不可信数据源的数据进行校验。

"
"禁用XML外部实体处理。

说明：允许对包含用户提供数据的XML外部实体进行处理，可能导致敏感信息暴露，以及拒绝服务攻击。使用XML库的Java应用通常都会被这类漏洞影响，因为许多Java的XML解析器默认会处理外部实体。"
部署在互联网上的Web应用须保证注册过程不能自动机触发，例如在密码变更、创建用户、提交表单等操作时采用验证码、邮箱验证、IP注册间隔限制等措施防止攻击者未经确认自动完成操作。
禁用不受信任的ActiveX/applets插件；任何启用的插件都需要进行签名
所有提供Web服务部件都须具备failsafe或failover机制，以确保服务部件能在服务异常和遭受DoS攻击时退出到一个安全状态。
会话管理中，当参数包含session id时需要使用安全的传输通道，且不能被缓存。
"Web应用的输出需使用正确的字符集编码，正确的MIME类型
正确定义MIME，包括conten-type和Content-Transfer-Encoding，保证web应用可正确执行。"
除非已对输入数据进行充分验证和危险字符的过滤处理，否则不允许Web应用基于输入数据用来构建HTTP消息头

"对 Web Service 接口的调用必须进行认证。
说明：
认证就是确定谁在调用 Web Service，并且证实调用者身份。"
"对 Web Service 接口的调用必须进行鉴权。
说明：
鉴权就是判断调用者是否有权限调用该 Web Service 接口。"
"通过 Web Service 接口传递敏感数据时，必须保障其机密性。
如果Web service中传输的是高敏感等级的数据，如需要满足PCIDSS的信用卡数据，客户密码。这些数据必须使用端到端的应用级别的加密如XML加密。"
"通过 Web Service 接口传递重要的交易数据时，必须保障其完整性。
说明：
重要的交易数据，如转账时涉及的“转入帐号”、“转出帐号”、“金额”等。"
如果 Web Service 只对特定的 IP 开放，那么必须对调用 Web Service 接口的客户端 IP 进行鉴权，只有在 IP 地址白名单中的客户端才允许调用，IP 地址白名单可配置。
"对 Web Service 接口调用进行日志记录。
说明：
日志内容包括但不限于如下内容：调用时间、操作类型、调用接口名称、详细的接口参数、客户端IP、客户端机器名、调用者的用户标识、受影响的个体（数据、资源）、成功或失败标识。
相关参考：“对安全事件及操作事件记录日志”。"
必须对 Web Service 提交的参数进行输入校验。
"Web Service必须根据XML schema定义（XSD）来验证SOAP消息。

说明：Web Service必须根据XML schema定义（XSD）来验证SOAP消息，XSD至少必须为允许流入和流出Web Service的每一个参数定义最大长度和字符集；对于所有具有固定格式的参数（如：邮政编码，电话号码，列表值等），要定义强的校验模式，最理想的方式就是白名单校验模式。XML Schema 支持数据类型，可更容易地定义数据约束，可更容易地验证数据的正确性，可更容易地描述允许的文档内容。"
"根据实际业务需要，限制SOAP消息的大小为适当的值。

说明：就像Web应用程序，Web Service也成为拒绝服务攻击的目标，可以通过自动发送成千上万的大的SOAP消息，使应用无法响应合法的消息或者彻底瘫痪，从而导致Web Service拒绝服务。如果限制值太大（或根本没有限制），就会增加拒绝服务攻击成功的机会。"
"Web Service接口需要防御重放攻击。

说明：如果攻击者抓取整个SOAP消息，并多次向服务器重发该消息，则可能导致服务器重复多次处理该请求（例如：多次充值）。"
解析SOAP消息头以识别畸形的属性；丢弃并记录畸形的属性
限制SOAPAction头域的值为服务真实支持的已在WSDL中定义的消息；丢弃与这个限定不符的SOAP消息
"服务可丢弃携带DTD的SOAP消息，并为这个丢弃事件记录日志，同时可考虑提供告警
说明：soap语法：soap消息中一定不能包含DTD。当soap接收者收到一条包含dtd的soap消息时，必须要产生一个DTDNotSupported错误。"
如果SOAP消息允许携带附件，则须对附件进行恶意代码扫描；可使用病毒扫描工具
如果SOAP消息允许携带附件，则须只允许符合WSDL中指定的MIME类型的附件才可进行进一步处理；对于不符的附件应丢弃，并记录日志
